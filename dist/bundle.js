/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var e={116:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(7047),o=n(6646),i=n(9006),a=r(n(3326)),c=n(3015),l=n(2098);class d extends HTMLElement{boundHandleSubmit=this.handleSubmit.bind(this);constructor(){super(),this.attachShadow({mode:"open"})}uploadedImageUrl=null;selectedGameId=null;connectedCallback(){this.render();const e=this.shadowRoot?.querySelector("form"),t=this.shadowRoot?.querySelector("#login-link"),n=this.shadowRoot?.querySelector("#profilePicture");e?.addEventListener("submit",this.boundHandleSubmit),t?.addEventListener("click",(()=>(0,o.navigate)(i.Screens.LOGIN))),n?.addEventListener("change",this.handleFileChange.bind(this));const r=this.shadowRoot?.getElementById("game-input"),s=this.shadowRoot?.getElementById("game-suggestions");console.log(r,s),r?.addEventListener("input",(()=>{const e=r.value.toLowerCase().trim();console.log("Search query:",e),e&&s&&(s.innerHTML="",l.games.filter((t=>t.title.toLowerCase().includes(e))).slice(0,3).forEach((e=>{const t=document.createElement("li");t.textContent=e.title,t.dataset.id=e.id,t.classList.add("suggestion-item"),s.appendChild(t)})))})),s&&s?.addEventListener("click",(e=>{const t=e.target;t.classList.contains("suggestion-item")&&(this.selectedGameId=t.dataset.id||null,r.value=t.textContent||"",s.innerHTML="")}))}async handleFileChange(e){const t=e.target,n=t.files?.[0];if(n)try{const e=await(0,c.uploadPostPicture)(n);this.uploadedImageUrl=e,console.log("Uploaded to:",e),this.renderImage()}catch(e){console.error("Upload failed:",e),alert("Failed to upload image.")}}renderImage(){const e=this.shadowRoot?.querySelector(".image");e&&(e.style.backgroundImage=`linear-gradient(to top, rgba(191, 52, 103, 0.05), rgba(191, 52, 103, 0.05)), url(${this.uploadedImageUrl})`)}handleGameChange(e){const t=e.target;this.selectedGameId=t.value}async handleSubmit(e){if(e.preventDefault(),!s.appState.get().currentUser)return;const t=new FormData(e.target).get("content");if(t.trim())try{await(0,c.uploadPost)({content:t,url:this.uploadedImageUrl||void 0,gameId:this.selectedGameId||void 0})}catch(e){console.error("Error creating post:",e),alert("Failed to create post. Please try again.")}}render(){const e=s.appState.get();this.shadowRoot&&(this.shadowRoot.innerHTML=`\n        <style>${a.default}</style>\n        ${e.isAuthenticated?`\n            \x3c!-- Si el usuario ha iniciado sesión, muestra el formulario de creación de post --\x3e\n            <div class="create-post">\n              <div class="create-post-header">\n                <img src="${e.currentUser?.profilePicture}" alt="${e.currentUser?.username}" class="user-avatar">\n              </div>\n              <form class="post-form">\n                <div class="input-group">\n                  <textarea name="content" placeholder="What's on your mind?" required></textarea>\n                </div>\n                <div class="optional-wrapper">\n                \n                <div class="input-group image">\n                  <label class="custom-file-upload" for="profilePicture">\n                  <input type="file"  id="profilePicture" name="profilePicture" accept="image/*">\n                  <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>\n                    <circle cx="8.5" cy="8.5" r="1.5"/>\n                    <path d="M21 15l-5-5L5 21"/>\n                  </svg>\n                  </label>\n                </div>\n\n                <div class="input-group game">\n                    <input type="text" id="game-input" name="game-input" placeholder="Search a game..." autocomplete="off" />\n                    <ul id="game-suggestions" class="suggestions-list"></ul>\n                </div>\n                </div>\n                \n                <div class="post-actions">\n                  <button type="reset" class="post-button secondary">Clear</button>\n                  <button type="submit" class="post-button primary">Post</button>\n                </div>\n              </form>\n            </div>\n          `:'\n            \x3c!-- Si el usuario no ha iniciado sesión, muestra un mensaje para iniciar sesión --\x3e\n            <div class="create-post">\n              <div class="login-prompt">\n                <p>Please <a id="login-link">log in</a> to create a post</p>\n              </div>\n            </div>\n          '}\n      `)}disconnectedCallback(){const e=this.shadowRoot?.querySelector("form");e?.removeEventListener("submit",this.boundHandleSubmit)}}t.default=d},217:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=":host {\n  display: block;\n  font-family: 'Inter', sans-serif;\n}\n\n.threads-container {\n  min-height: 100vh;\n  padding: 90px max(2rem, calc((100% - 800px) / 2)) 2rem;\n  background-color: var(--color-background);\n  color: var(--color-input-text);\n}\n\n.threads-header {\n  margin-bottom: 2rem;\n  text-align: center;\n}\n\n.threads-header h2 {\n  font-size: 2.2rem;\n  font-weight: 700;\n  margin-bottom: 0.5rem;\n  color: var(--color-primary-text);\n}\n\n.threads-header p {\n  color: var(--color-muted);\n  font-size: 1rem;\n  max-width: 600px;\n  margin: 0 auto;\n}\n\n.threads-feed {\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n}\n\n.no-posts {\n  background-color: var(--color-input-background);\n  border-radius: 8px;\n  padding: 2rem;\n  text-align: center;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.no-posts p {\n  color: var(--color-muted);\n  font-size: 1.1rem;\n  margin: 0;\n}\n\n@media (max-width: 768px) {\n  .threads-container {\n    padding: 80px 1rem 2rem;\n  }\n\n  .threads-header h2 {\n    font-size: 1.8rem;\n  }\n\n  .threads-header p {\n    font-size: 0.95rem;\n  }\n}\n\n@media (max-width: 480px) {\n  .threads-header h2 {\n    font-size: 1.6rem;\n  }\n\n  .threads-header p {\n    font-size: 0.9rem;\n  }\n\n  .no-posts {\n    padding: 1.5rem;\n  }\n\n  .no-posts p {\n    font-size: 1rem;\n  }\n}\n"},304:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=":host {\n  display: block;\n  font-family: 'Inter', sans-serif;\n}\n\n.game-card {\n  background-color: var(--color-panel);\n  border-radius: 10px;\n  overflow: hidden;\n  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);\n  transition: transform 0.3s ease, box-shadow 0.3s ease;\n  cursor: pointer;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\n.game-card:hover {\n  transform: translateY(-5px);\n  box-shadow: 0 12px 20px rgba(0, 0, 0, 0.3);\n}\n\n.game-image-container {\n  position: relative;\n  height: 180px;\n  overflow: hidden;\n}\n\n.game-image {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  transition: transform 0.5s ease;\n}\n\n.game-card:hover .game-image {\n  transform: scale(1.05);\n}\n\n.game-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: linear-gradient(\n    to bottom,\n    rgba(0, 0, 0, 0.1),\n    rgba(0, 0, 0, 0.7)\n  );\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  opacity: 0;\n  transition: opacity 0.3s ease;\n}\n\n.game-card:hover .game-overlay {\n  opacity: 1;\n}\n\n.view-more {\n  background-color: var(--color-rose);\n  color: var(--color-primary-text);\n  padding: 0.5rem 1rem;\n  border-radius: 4px;\n  font-size: 0.9rem;\n  font-weight: 600;\n  transform: translateY(20px);\n  transition: transform 0.3s ease;\n}\n\n.game-card:hover .view-more {\n  transform: translateY(0);\n}\n\n.game-info {\n  padding: 1rem;\n  display: flex;\n  flex-direction: column;\n  flex-grow: 1;\n}\n\n.game-title {\n  margin: 0 0 0.5rem;\n  color: var(--color-input-text);\n  font-size: 1.1rem;\n  font-weight: 600;\n}\n\n.game-meta {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-top: auto;\n}\n\n.game-category {\n  color: var(--color-rose);\n  font-size: 0.85rem;\n  font-weight: 500;\n  padding: 0.2rem 0.6rem;\n  background-color: rgba(191, 52, 103, 0.1);\n  border-radius: 4px;\n}\n\n.game-rating {\n  display: flex;\n  align-items: center;\n}\n\n.star {\n  color: var(--color-border);\n  font-size: 1rem;\n  margin-left: 2px;\n}\n\n.star.filled {\n  color: #ffd600;\n}\n\n.star.half {\n  position: relative;\n  color: var(--color-border);\n}\n\n.star.half:before {\n  content: '★';\n  position: absolute;\n  color: #ffd600;\n  width: 50%;\n  overflow: hidden;\n}\n\n@media (max-width: 768px) {\n  .game-image-container {\n    height: 150px;\n  }\n\n  .game-title {\n    font-size: 1rem;\n  }\n\n  .game-category {\n    font-size: 0.8rem;\n  }\n\n  .star {\n    font-size: 0.9rem;\n  }\n}\n\n@media (max-width: 480px) {\n  .game-image-container {\n    height: 130px;\n  }\n  \n  .game-info {\n    padding: 0.8rem;\n  }\n\n  .game-title {\n    font-size: 0.95rem;\n  }\n\n  .view-more {\n    font-size: 0.8rem;\n    padding: 0.4rem 0.8rem;\n  }\n}\n"},723:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=":host {\n  display: block;\n  font-family: 'Inter', sans-serif;\n}\n\n.auth-container {\n  min-height: 100vh;\n  padding: 70px 0 0;\n  background-color: var(--color-background);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n}\n\n.auth-content {\n  display: flex;\n  justify-content: space-between;\n  background-color: var(--color-panel);\n  border-radius: 12px;\n  box-shadow: 0 15px 30px rgba(11, 14, 23, 0.3);\n  margin: 0;\n  width: 90%;\n  max-width: 1000px;\n  position: relative;\n}\n\n.form-wrapper.active{\n  display: block;\n}\n\n.form-wrapper.hide{\n  display: none;\n}\n\n/* Contenedor de formularios - Versión Desktop */\n.form-container {\n  width: 60%;\n  min-width: 400px;\n  position: relative;\n  background-color: white;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background-color: white;\n}\n\n\n.form-wrapper {\n  transition: all 0.4s ease-in-out;\n  width: 60%;\n  display: flex;\n  justify-content: center;\n  align-content: center;\n  padding-left: 10%;\n}\n\n\n/* Sección de imagen */\n.auth-image {\n  width: 40%;\n  background: url('https://images.pexels.com/photos/7915239/pexels-photo-7915239.jpeg') no-repeat center;\n  background-size: cover;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-height: 500px;\n  \n}\n\n.image-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: linear-gradient(135deg, rgba(191, 52, 103, 0.8), rgba(191, 52, 103, 0.6));\n  z-index: 1;\n}\n\n.welcome-text {\n  position: relative;\n  z-index: 2;\n  text-align: center;\n  padding: 2rem;\n  color: var(--color-input-text);\n}\n\n.welcome-text h2 {\n  font-size: 2.5rem;\n  font-weight: 700;\n  margin-bottom: 1rem;\n  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);\n}\n\n.welcome-text p {\n  font-size: 1.2rem;\n  max-width: 300px;\n  margin: 0 auto;\n  line-height: 1.5;\n  text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);\n}\n\n/* ------------------------- */\n/* RESPONSIVE DESIGN */\n/* ------------------------- */\n\n@media (max-width: 992px) {\n  .auth-content {\n    flex-direction: column;\n    width: 100%;\n    max-width: 500px;\n    border-radius: 0;\n    box-shadow: none;\n  }\n\n  .form-container, \n  .auth-image {\n    width: 100%;\n    min-width: auto;\n  }\n\n  /* Mobile - Mostrar solo un formulario a la vez */\n  .form-wrapper {\n    padding: 2.5rem 1.5rem;\n    opacity: 1 !important;\n    visibility: visible !important;\n    transform: none !important;\n    position: relative;\n  }\n\n  .auth-image {\n    min-height: 250px;\n    order: -1;\n  }\n\n  .welcome-text {\n    padding: 1.5rem;\n  }\n\n  .welcome-text h2 {\n    font-size: 2rem;\n  }\n}\n\n@media (max-width: 576px) {\n  .auth-container {\n    padding-top: 60px;\n  }\n\n  .form-wrapper {\n    padding: 2rem 1.25rem;\n  }\n\n  .auth-image {\n    min-height: 200px;\n  }\n\n  .welcome-text h2 {\n    font-size: 1.8rem;\n  }\n\n  .welcome-text p {\n    font-size: 1rem;\n    max-width: 250px;\n  }\n}\n\n@media (max-width: 400px) {\n  .form-wrapper {\n    padding: 1.75rem 1rem;\n  }\n\n  .auth-image {\n    min-height: 180px;\n  }\n}"},839:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r="\n\n:host {\n  display: block;\n  font-family: 'Inter', sans-serif;\n}\n\n.login-container {\n  background-color: var(--color-panel);\n  border-radius: 10px;\n  padding: 2rem;\n  max-width: 400px;\n  width: 100%;\n  animation: fadeIn 0.6s ease;\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\nh2 {\n  color: var(--color-input-text);\n  text-align: center;\n  margin: 0 0 2rem;\n  font-size: 1.8rem;\n  font-weight: 700;\n}\n\n.form-group {\n  margin-bottom: 1.5rem;\n}\n\nlabel {\n  display: block;\n  margin-bottom: 0.5rem;\n  color: var(--color-muted);\n  font-size: 0.9rem;\n  font-weight: 500;\n}\n\ninput {\n  width: 95%;\n  padding: 0.8rem 1rem;\n  border: 2px solid var(--color-border);\n  background-color: var(--color-input-background);\n  color: var(--color-input-text);\n  border-radius: 6px;\n  font-size: 1rem;\n  transition: border-color 0.3s ease, box-shadow 0.3s ease;\n}\n\ninput:focus {\n  outline: none;\n  border-color: var(--color-rose);\n  box-shadow: 0 0 0 3px rgba(191, 52, 103, 0.2);\n}\n\n.login-button {\n  width: 100%;\n  padding: 1rem;\n  background-color: var(--color-rose);\n  color: var(--color-primary-text);\n  border: none;\n  border-radius: 6px;\n  font-size: 1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: background-color 0.3s ease, transform 0.2s ease;\n  margin-top: 1.5rem;\n}\n\n.login-button:hover {\n  background-color: #a02b57;\n  transform: translateY(-2px);\n}\n\n.login-button:active {\n  transform: translateY(0);\n}\n\n.register-text {\n  text-align: center;\n  margin-top: 1.5rem;\n  color: var(--color-muted);\n  font-size: 0.9rem;\n}\n\na {\n  color: var(--color-rose);\n  text-decoration: none;\n  font-weight: 600;\n  transition: color 0.3s ease;\n}\n\na:hover {\n  color: #a02b57;\n  text-decoration: underline;\n}\n\n@media (max-width: 480px) {\n  .login-container {\n    padding: 1.5rem;\n  }\n\n  h2 {\n    font-size: 1.5rem;\n    margin-bottom: 1.5rem;\n  }\n\n  input {\n    padding: 0.7rem 0.9rem;\n    font-size: 0.95rem;\n  }\n\n  .login-button {\n    padding: 0.8rem;\n  }\n}\n"},861:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=":host {\n  display: block;\n  font-family: 'Inter', sans-serif;\n}\n\n.community-container {\n  min-height: 100vh;\n  padding: 90px max(2rem, calc((100% - 1200px) / 2)) 2rem;\n  background-color: var(--color-background);\n  color: #e0e0e0;\n}\n\n.community-header {\n  margin-bottom: 3rem;\n  text-align: center;\n}\n\n.community-header h2 {\n  font-size: 2.5rem;\n  font-weight: 700;\n  margin-bottom: 0.5rem;\n  color: #fff;\n}\n\n.community-header p {\n  color: #bdbdbd;\n  font-size: 1.1rem;\n}\n\n.community-content {\n  display: grid;\n  grid-template-columns: 1fr 350px;\n  gap: 2rem;\n}\n\n.main-content {\n  display: flex;\n  flex-direction: column;\n  gap: 3rem;\n}\n\n.community-section {\n  background-color: var(--color-panel);\n  border-radius: 10px;\n  padding: 1.5rem;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n.community-section h3 {\n  margin-top: 0;\n  margin-bottom: 1.5rem;\n  font-size: 1.4rem;\n  font-weight: 600;\n  color: #e0e0e0;\n  padding-bottom: 0.8rem;\n  border-bottom: 1px solid #333;\n}\n\n.recent-posts {\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n}\n\n.stats-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));\n  gap: 1.5rem;\n}\n\n.stat-card {\n  background-color:var(--color-panel);\n  padding: 1.5rem;\n  border-radius: 8px;\n  text-align: center;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  transition: transform 0.3s ease;\n}\n\n.stat-card:hover {\n  transform: translateY(-5px);\n}\n\n.stat-value {\n  font-size: 1.8rem;\n  font-weight: 700;\n  color:var(--color-rose);\n  margin-bottom: 0.5rem;\n}\n\n.stat-label {\n  font-size: 0.9rem;\n  color: var(--color-rose);\n}\n\n.guidelines {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 1.5rem;\n}\n\n.guideline-item {\n  background-color: var(--color-panel);\n  padding: 1.2rem;\n  border-radius: 8px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  transition: transform 0.3s ease, box-shadow 0.3s ease;\n}\n\n.guideline-item:hover {\n  transform: translateY(-3px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.guideline-item h4 {\n  margin-top: 0;\n  margin-bottom: 0.8rem;\n  color: var(--color-rose);\n  font-size: 1.1rem;\n}\n\n.guideline-item p {\n  margin: 0;\n  color: #bdbdbd;\n  font-size: 0.9rem;\n  line-height: 1.5;\n}\n\n.sidebar {\n  display: flex;\n  flex-direction: column;\n  gap: 2rem;\n}\n\n.sidebar-section {\n  background-color:var(--color-panel);\n  border-radius: 10px;\n  padding: 1.5rem;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n.sidebar-section h3 {\n  margin-top: 0;\n  margin-bottom: 1.5rem;\n  font-size: 1.3rem;\n  font-weight: 600;\n  color: #e0e0e0;\n  padding-bottom: 0.8rem;\n  border-bottom: 1px solid #333;\n}\n\n.trending-topics {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n.topic-item {\n  background-color: var(--color-panel);\n  padding: 1rem;\n  border-radius: 8px;\n  cursor: pointer;\n  transition: transform 0.3s ease, background-color 0.3s ease;\n}\n\n.topic-item:hover {\n  background-color:var(--color-background);\n  transform: translateY(-2px);\n}\n\n.topic-item h4 {\n  margin-top: 0;\n  margin-bottom: 0.5rem;\n  color: #e0e0e0;\n  font-size: 1.1rem;\n  font-weight: 600;\n}\n\n.topic-item p {\n  margin: 0 0 1rem;\n  color: #bdbdbd;\n  font-size: 0.85rem;\n  line-height: 1.4;\n}\n\n.topic-meta {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.topic-category {\n  color: var(--color-rose);\n  font-size: 0.8rem;\n  font-weight: 500;\n  padding: 0.2rem 0.5rem;\n  background-color: rgba(191, 52, 103, 0.2);\n  border-radius: 4px;\n}\n\n.topic-action {\n  color: var(--color-rose);\n  font-size: 0.85rem;\n  font-weight: 600;\n  transition: color 0.3s ease;\n}\n\n.topic-item:hover .topic-action {\n  text-decoration: underline;\n}\n\n.join-community {\n  text-align: center;\n}\n\n.join-community p {\n  margin: 0 0 1.5rem;\n  color: #bdbdbd;\n  font-size: 0.95rem;\n  line-height: 1.5;\n}\n\n.join-btn {\n  background-color:  var(--color-rose);\n  color: white;\n  border: none;\n  border-radius: 6px;\n  padding: 0.8rem 1.5rem;\n  font-size: 1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  width: 100%;\n}\n\n.join-btn:hover {\n  background-color:  var(--color-rose);\n  transform: translateY(-2px);\n  box-shadow: 0 4px 10px var(--color-rose)\n}\n\n@media (max-width: 992px) {\n  .community-content {\n    grid-template-columns: 1fr;\n  }\n\n  .sidebar {\n    order: -1;\n  }\n\n  .sidebar-section {\n    padding: 1.2rem;\n  }\n}\n\n@media (max-width: 768px) {\n  .community-container {\n    padding: 80px 1rem 2rem;\n  }\n\n  .community-header h2 {\n    font-size: 2.2rem;\n  }\n\n  .community-header p {\n    font-size: 1rem;\n  }\n\n  .community-section, .sidebar-section {\n    padding: 1.2rem;\n  }\n\n  .community-section h3, .sidebar-section h3 {\n    font-size: 1.3rem;\n  }\n\n  .stats-grid {\n    grid-template-columns: repeat(2, 1fr);\n  }\n}\n\n@media (max-width: 480px) {\n  .community-header h2 {\n    font-size: 1.8rem;\n  }\n\n  .community-header p {\n    font-size: 0.9rem;\n  }\n\n  .community-section, .sidebar-section {\n    padding: 1rem;\n  }\n\n  .community-section h3, .sidebar-section h3 {\n    font-size: 1.2rem;\n    margin-bottom: 1.2rem;\n  }\n\n  .stats-grid {\n    gap: 1rem;\n  }\n\n  .stat-value {\n    font-size: 1.5rem;\n  }\n\n  .stat-label {\n    font-size: 0.8rem;\n  }\n}"},907:(e,t,n)=>{n.r(t),n.d(t,{Headers:()=>i,Request:()=>a,Response:()=>c,default:()=>o,fetch:()=>s});var r=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("unable to locate global object")}();const s=r.fetch,o=r.fetch.bind(r),i=r.Headers,a=r.Request,c=r.Response},1043:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=":host {\n  display: block;\n  font-family: 'Inter', sans-serif;\n}\n\n.categories-container {\n  min-height: 100vh;\n  padding: 90px max(2rem, calc((100% - 1100px) / 2)) 2rem;\n  background-color: var(--color-background);\n  color: var(--color-input-text);\n}\n\n.categories-header {\n  margin-bottom: 2rem;\n  text-align: center;\n}\n\n.categories-header h2 {\n  font-size: 2.2rem;\n  font-weight: 700;\n  margin-bottom: 0.5rem;\n  color: var(--color-white);\n}\n\n.categories-header p {\n  color: var(--color-placeholder);\n  font-size: 1rem;\n}\n\n.categories-header p strong {\n  color: var(--color-rose);\n}\n\n.categories-list {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 1rem;\n  justify-content: center;\n  margin-bottom: 2.5rem;\n}\n\n.category-item {\n  padding: 0.7rem 1.3rem;\n  background-color: var(--color-panel);\n  border-radius: 30px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.category-item:hover {\n  background-color: #a62d57; /* can keep this as it’s a transparent purple */\n  transform: translateY(-2px);\n}\n\n.category-item.active {\n  background-color: var(--color-rose);\n  color: var(--color-white);\n  box-shadow: 0 4px 10px var(--color-rose)\n}\n\n.category-item span {\n  font-size: 0.9rem;\n  font-weight: 500;\n}\n\n.category-posts {\n  margin-top: 2rem;\n}\n\n.category-posts h3 {\n  font-size: 1.6rem;\n  font-weight: 600;\n  margin-bottom: 1.5rem;\n  color: var(--color-input-text);\n  text-align: center;\n}\n\n.posts-grid {\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n  max-width: 800px;\n  margin: 0 auto;\n}\n\n.no-posts {\n  background-color: var(--color-panel);\n  border-radius: 8px;\n  padding: 2rem;\n  text-align: center;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.no-posts p {\n  color: var(--color-placeholder);\n  font-size: 1.1rem;\n  margin: 0;\n}\n\n@media (max-width: 768px) {\n  .categories-container {\n    padding: 80px 1rem 2rem;\n  }\n\n  .categories-header h2 {\n    font-size: 1.8rem;\n  }\n\n  .categories-list {\n    flex-wrap: nowrap;\n    overflow-x: auto;\n    padding-bottom: 0.5rem;\n    justify-content: flex-start;\n    -webkit-overflow-scrolling: touch;\n    scrollbar-width: thin;\n    scroll-padding: 0 1rem;\n  }\n\n  .categories-list::-webkit-scrollbar {\n    height: 4px;\n  }\n\n  .categories-list::-webkit-scrollbar-thumb {\n    background-color: var(--color-rose);\n    border-radius: 4px;\n  }\n\n  .category-item {\n    flex-shrink: 0;\n  }\n\n  .category-posts h3 {\n    font-size: 1.4rem;\n  }\n}\n\n@media (max-width: 480px) {\n  .categories-header h2 {\n    font-size: 1.6rem;\n  }\n\n  .categories-header p {\n    font-size: 0.9rem;\n  }\n\n  .category-item {\n    padding: 0.6rem 1rem;\n  }\n\n  .category-item span {\n    font-size: 0.85rem;\n  }\n\n  .category-posts h3 {\n    font-size: 1.3rem;\n  }\n}\n"},1187:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(7047),o=n(9006);n(8683),n(4613);const i=r(n(723));class a extends HTMLElement{showRegister=!1;constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const e=s.appState.get();this.showRegister=e.currentScreen===o.Screens.REGISTER,this.render()}render(){if(!this.shadowRoot)return;const e=this.showRegister?"<register-form></register-form>":"<login-form></login-form>";this.shadowRoot.innerHTML=`\n      <style>${i.default}</style>\n      <div class="auth-container">\n        <div class="auth-content">\n          <div class="form-wrapper">\n            ${e}\n          </div>\n          <div class="auth-image">\n            <div class="image-overlay"></div>\n            <div class="welcome-text">\n              <h2>Welcome to Nexus</h2>\n              <p>The ultimate social platform for gamers</p>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;const t=this.shadowRoot.querySelector("login-form"),n=this.shadowRoot.querySelector("register-form");t?.addEventListener("register",(()=>{this.showRegister=!0,this.render()})),n?.addEventListener("login",(()=>{this.showRegister=!1,this.render()}))}disconnectedCallback(){}}t.default=a},1256:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=(0,n(7470).createClient)("https://mvqpebqiqzggtxuilevl.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im12cXBlYnFpcXpnZ3R4dWlsZXZsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDkxNDQ0MzQsImV4cCI6MjA2NDcyMDQzNH0.d_wLZVTPP0kEwNQYReNbMJ-Q-krj0PTjP8QJ7AekibA");t.default=r},1591:e=>{e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},1961:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(5045)),o=r(n(3825)),i=n(3530);class a{constructor(e,{headers:t={},schema:n,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},i.DEFAULT_HEADERS),t),this.schemaName=n,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new s.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new a(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:n=!1,get:r=!1,count:s}={}){let i;const a=new URL(`${this.url}/rpc/${e}`);let c;n||r?(i=n?"HEAD":"GET",Object.entries(t).filter((([e,t])=>void 0!==t)).map((([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`])).forEach((([e,t])=>{a.searchParams.append(e,t)}))):(i="POST",c=t);const l=Object.assign({},this.headers);return s&&(l.Prefer=`count=${s}`),new o.default({method:i,url:a,headers:l,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}}t.default=a},2098:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.games=void 0;const r=n(4734);t.games=[{id:"1",title:"The Last Guardian",category:r.Category.ADVENTURE,imageUrl:"https://i.ytimg.com/vi/iZ4UPziWmUo/hq720.jpg?sqp=-oaymwEXCK4FEIIDSFryq4qpAwkIARUAAIhCGAE=&rs=AOn4CLDvcrQ3AEslDFc38NUIxx8CiU-JlA",description:"An action-adventure game that follows a young boy who befriends a giant half-bird, half-mammal creature named Trico.",rating:4.5,releaseDate:"2016-12-06"},{id:"2",title:"Outlast",category:r.Category.HORROR,imageUrl:"https://image.api.playstation.com/cdn/UP2113/CUSA00325_00/M7Xcn9Q7mUkmm3dSilcsbkORlPPiQ0VK.png",description:"A first-person survival horror game where you must survive the horrors of Mount Massive Asylum.",rating:4.2,releaseDate:"2013-09-04"},{id:"3",title:"Final Fantasy VII Remake",category:r.Category.RPG,imageUrl:"https://upload.wikimedia.org/wikipedia/en/c/ce/FFVIIRemake.png",description:"A reimagining of the iconic RPG that follows Cloud Strife, a former SOLDIER, as he joins an eco-terrorist group to fight against the Shinra Electric Power Company.",rating:4.8,releaseDate:"2020-04-10"},{id:"4",title:"Forza Horizon 5",category:r.Category.RACING,imageUrl:"https://image.api.playstation.com/vulcan/ap/rnd/202502/1900/631436cfbc1d64659c778e3783f29fafad6022145e0ffec8.jpg",description:"An open-world racing game set in a fictionalized representation of Mexico.",rating:4.7,releaseDate:"2021-11-09"},{id:"5",title:"Age of Empires IV",category:r.Category.STRATEGY,imageUrl:"https://static.wikia.nocookie.net/ageofempires/images/f/f4/AoE4_Wallpaper_X1_768x432.jpg/revision/latest?cb=20210615074024&path-prefix=es",description:"A real-time strategy game that focuses on historical events throughout the Middle Ages.",rating:4.3,releaseDate:"2021-10-28"},{id:"6",title:"FIFA 23",category:r.Category.SPORTS,imageUrl:"https://juegosdigitalescolombia.com/files/images/productos/1673124993-fifa-23-espanol-espana-ps4-0.jpg",description:"A football simulation game that features the 2022 FIFA World Cup.",rating:4,releaseDate:"2022-09-30"},{id:"7",title:"Street Fighter 6",category:r.Category.FIGHTING,imageUrl:"https://image.api.playstation.com/vulcan/ap/rnd/202211/1408/ENialNds5tXo7Mb9ahX2yESt.png",description:"A fighting game that introduces new mechanics and game modes.",rating:4.6,releaseDate:"2023-06-02"},{id:"8",title:"God of War Ragnarök",category:r.Category.ACTION,imageUrl:"https://upload.wikimedia.org/wikipedia/en/e/ee/God_of_War_Ragnar%C3%B6k_cover.jpg",description:"An action game that continues the story of Kratos and his son Atreus as they face the impending Ragnarök.",rating:4.9,releaseDate:"2022-11-09"},{id:"9",title:"Schedule",category:r.Category.RPG,imageUrl:"https://shared.fastly.steamstatic.com/store_item_assets/steam/apps/3164500/header.jpg",description:"From small-time dope pusher to kingpin - manufacture and distribute a range of drugs throughout the grungy city of Hyland Point.",rating:4.2,releaseDate:"2025-03-24"}]},2279:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const s=r(n(1961));t.PostgrestClient=s.default;const o=r(n(5045));t.PostgrestQueryBuilder=o.default;const i=r(n(3825));t.PostgrestFilterBuilder=i.default;const a=r(n(8261));t.PostgrestTransformBuilder=a.default;const c=r(n(4279));t.PostgrestBuilder=c.default;const l=r(n(6818));t.PostgrestError=l.default,t.default={PostgrestClient:s.default,PostgrestQueryBuilder:o.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:c.default,PostgrestError:l.default}},2553:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(7047),o=n(6646),i=n(9006);n(4590);const a=r(n(861));class c extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render();const e=this.shadowRoot?.querySelectorAll(".topic-item");e?.forEach((e=>{e.addEventListener("click",(()=>{const t=e.getAttribute("data-category");t&&(0,o.navigate)(i.Screens.CATEGORIES,void 0,t)}))}))}renderRecentPosts(){return[...s.appState.get().posts].sort(((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime())).slice(0,3).map((e=>`\n      <post-card\n        postid="${e.id}"\n        userid="${e.userId}"\n        username="${e.username}"\n        pfp="${e.profilePicture}"\n        content="${e.content}"\n        ${e.imageUrl?`imageurl="${e.imageUrl}"`:""}\n        likes="${e.likes}"\n        reposts="${e.reposts}"\n        comments="${e.comments}"\n        saves="${e.saves}"\n        timestamp="${e.timestamp}"\n        ${e.gameId?`gameid="${e.gameId}"`:""}\n        isliked="${e.isLiked||!1}"\n        issaved="${e.isSaved||!1}">\n      </post-card>\n    `)).join("")}renderTrendingTopics(){return[{name:"Horror Games",category:"Horror",description:"Explore the scariest games in the community."},{name:"RPG Adventures",category:"RPG",description:"Discuss character builds, storylines, and strategy."},{name:"Racing Showdown",category:"Racing",description:"Share your best times and racing tips."},{name:"Strategy Masters",category:"Strategy",description:"Plan, execute, and conquer in strategy games."},{name:"Action Highlights",category:"Action",description:"Fast-paced action game discussions and clips."}].map((e=>`\n      <div class="topic-item" data-category="${e.category}">\n        <h4>${e.name}</h4>\n        <p>${e.description}</p>\n        <div class="topic-meta">\n          <span class="topic-category">${e.category}</span>\n          <span class="topic-action">Explore</span>\n        </div>\n      </div>\n    `)).join("")}render(){if(this.shadowRoot){this.shadowRoot.innerHTML=`\n        <style>${a.default}</style>\n        <div class="community-container">\n          <div class="community-header">\n            <h2>Nexus Community</h2>\n            <p>Connect, discuss, and share with fellow gamers</p>\n          </div>\n          \n          <div class="community-content">\n            <div class="main-content">\n              <section class="community-section">\n                <h3>Recent Discussions</h3>\n                <div class="recent-posts">\n                  ${this.renderRecentPosts()}\n                </div>\n              </section>\n              \n              <section class="community-section">\n                <h3>Community Stats</h3>\n                <div class="stats-grid">\n                  <div class="stat-card">\n                    <div class="stat-value">2,500+</div>\n                    <div class="stat-label">Members</div>\n                  </div>\n                  <div class="stat-card">\n                    <div class="stat-value">10K+</div>\n                    <div class="stat-label">Posts</div>\n                  </div>\n                  <div class="stat-card">\n                    <div class="stat-value">30K+</div>\n                    <div class="stat-label">Comments</div>\n                  </div>\n                  <div class="stat-card">\n                    <div class="stat-value">100+</div>\n                    <div class="stat-label">Games</div>\n                  </div>\n                </div>\n              </section>\n              \n              <section class="community-section">\n                <h3>Community Guidelines</h3>\n                <div class="guidelines">\n                  <div class="guideline-item">\n                    <h4>Be Respectful</h4>\n                    <p>Treat others with respect. No harassment, hate speech, or trolling.</p>\n                  </div>\n                  <div class="guideline-item">\n                    <h4>Stay On Topic</h4>\n                    <p>Keep discussions relevant to gaming and the community.</p>\n                  </div>\n                  <div class="guideline-item">\n                    <h4>No Spoilers</h4>\n                    <p>Use spoiler tags when discussing game endings or major plot points.</p>\n                  </div>\n                  <div class="guideline-item">\n                    <h4>Be Constructive</h4>\n                    <p>Aim for meaningful contributions to discussions.</p>\n                  </div>\n                </div>\n              </section>\n            </div>\n            \n            <div class="sidebar">\n              <section class="sidebar-section">\n                <h3>Trending Topics</h3>\n                <div class="trending-topics">\n                  ${this.renderTrendingTopics()}\n                </div>\n              </section>\n              \n              <section class="sidebar-section">\n                <h3>Join the Community</h3>\n                <div class="join-community">\n                  <p>Connect with other gamers and share your experiences.</p>\n                  <button class="join-btn">Create Account</button>\n                </div>\n              </section>\n            </div>\n          </div>\n        </div>\n      `;const e=this.shadowRoot.querySelector(".join-btn");e?.addEventListener("click",(()=>{(0,o.navigate)(i.Screens.REGISTER)}))}}disconnectedCallback(){}}t.default=c},2555:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(7047),o=n(6646),i=n(4734);n(4590);const a=r(n(1043));class c extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render();const e=this.shadowRoot?.querySelectorAll(".category-item");e?.forEach((e=>{e.addEventListener("click",(()=>{const t=e.getAttribute("data-category");(0,o.filterByCategory)(t),this.render()}))}))}renderCategories(){const e=s.appState.get();return Object.values(i.Category).map((t=>`\n      <div class="category-item ${e.currentCategoryFilter===t?"active":""}" data-category="${t}">\n        <span>${t}</span>\n      </div>\n    `)).join("")}renderPosts(){const e=s.appState.get().filteredPosts;return 0===e.length?'\n        <div class="no-posts">\n          <p>No posts found in this category.</p>\n        </div>\n      ':e.map((e=>`\n      <post-card\n        postid="${e.id}"\n        userid="${e.userId}"\n        username="${e.username}"\n        pfp="${e.profilePicture}"\n        content="${e.content}"\n        ${e.imageUrl?`imageurl="${e.imageUrl}"`:""}\n        likes="${e.likes}"\n        reposts="${e.reposts}"\n        comments="${e.comments}"\n        saves="${e.saves}"\n        timestamp="${e.timestamp}"\n        ${e.gameId?`gameid="${e.gameId}"`:""}\n        isliked="${e.isLiked||!1}"\n        issaved="${e.isSaved||!1}">\n      </post-card>\n    `)).join("")}render(){const e=s.appState.get();this.shadowRoot&&(this.shadowRoot.innerHTML=`\n        <style>${a.default}</style>\n        <div class="categories-container">\n          <div class="categories-header">\n            <h2>Game Categories</h2>\n            <p>\n              ${e.currentCategoryFilter?`Showing posts in <strong>${e.currentCategoryFilter}</strong> category`:"Select a category to filter posts"}\n            </p>\n          </div>\n          \n          <div class="categories-list">\n            <div class="category-item ${null===e.currentCategoryFilter?"active":""}" data-category="">\n              <span>All Categories</span>\n            </div>\n            ${this.renderCategories()}\n          </div>\n          \n          <div class="category-posts">\n            <h3>\n              ${e.currentCategoryFilter?`${e.currentCategoryFilter} Games`:"All Posts"}\n            </h3>\n            \n            <div class="posts-grid">\n              ${this.renderPosts()}\n            </div>\n          </div>\n        </div>\n      `,this.shadowRoot.querySelectorAll(".category-item").forEach((e=>{e.addEventListener("click",(()=>{const t=e.getAttribute("data-category");(0,o.filterByCategory)(t||null),this.render()}))})))}disconnectedCallback(){}}t.default=c},2682:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=":host {\n  display: block;\n  font-family: 'Inter', sans-serif;\n}\n\n.comment-card {\n  background-color: var(--color-panel);\n  border-radius: 8px;\n  padding: 1rem;\n  margin-bottom: 1rem;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  transition: transform 0.3s ease, box-shadow 0.3s ease;\n}\n\n.comment-card:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.comment-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 0.8rem;\n}\n\n.profile-picture {\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  object-fit: cover;\n  margin-right: 0.8rem;\n  border: 2px solid var(--color-rose);\n  transition: transform 0.3s ease;\n}\n\n.profile-picture:hover {\n  transform: scale(1.1);\n}\n\n.comment-info {\n  display: flex;\n  flex-direction: column;\n}\n\n.username {\n  margin: 0;\n  font-size: 0.9rem;\n  font-weight: 600;\n  color: var(--color-input-text);\n}\n\n.timestamp {\n  font-size: 0.7rem;\n  color: var(--color-muted);\n}\n\n.comment-content {\n  margin-bottom: 0.8rem;\n}\n\n.comment-content p {\n  margin: 0;\n  font-size: 0.95rem;\n  line-height: 1.4;\n  color: var(--color-input-text);\n}\n\n.comment-actions {\n  display: flex;\n  gap: 1rem;\n  padding-top: 0.5rem;\n  border-top: 1px solid var(--color-input-background);\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n  color: var(--color-muted);\n  transition: color 0.3s ease;\n  cursor: pointer;\n  padding: 0.3rem;\n  border-radius: 4px;\n  font-size: 0.8rem;\n}\n\n.action-btn:hover {\n  color: var(--color-rose);\n  background-color: rgba(191, 52, 103, 0.1);\n}\n\n.action-btn svg {\n  fill: none;\n  stroke: currentColor;\n  stroke-width: 2;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n  transition: fill 0.3s ease, stroke 0.3s ease;\n}\n\n.like-btn.active {\n  color: #ff5252;\n}\n\n.like-btn.active svg {\n  fill: #ff5252;\n  stroke: #ff5252;\n}\n\n@media (max-width: 768px) {\n  .comment-card {\n    padding: 0.8rem;\n  }\n\n  .profile-picture {\n    width: 32px;\n    height: 32px;\n  }\n\n  .username {\n    font-size: 0.85rem;\n  }\n\n  .comment-content p {\n    font-size: 0.9rem;\n  }\n}\n\n@media (max-width: 480px) {\n  .comment-card {\n    padding: 0.7rem;\n  }\n\n  .action-btn {\n    font-size: 0.75rem;\n  }\n}"},2697:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AppDispatcher=t.Dispatcher=void 0;class n{_listeners;constructor(){this._listeners=[]}register(e){this._listeners.push(e)}dispatch(e){for(const t of this._listeners)t(e)}}t.Dispatcher=n,t.AppDispatcher=new n},2846:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=":host {\n  display: block;\n  font-family: 'Inter', sans-serif;\n}\n\n.thread-detail-container {\n  min-height: 100vh;\n  display: grid;\n  grid-template-columns: 1fr 300px;\n  gap: 2rem;\n  padding: 90px max(2rem, calc((100% - 1100px) / 2)) 2rem;\n  background-color: var(--color-background);\n  color: var(--color-input-text);\n}\n\n.thread-content {\n  display: flex;\n  flex-direction: column;\n}\n\n.back-button {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  color: var(--color-muted);\n  cursor: pointer;\n  margin-bottom: 1.5rem;\n  width: fit-content;\n  padding: 0.5rem;\n  border-radius: 4px;\n  transition: background-color 0.3s ease, color 0.3s ease;\n}\n\n.back-button:hover {\n  background-color: rgba(255, 255, 255, 0.05);\n  color: var(--color-rose);\n}\n\n.back-button svg {\n  fill: none;\n  stroke: currentColor;\n  stroke-width: 2;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n  transition: transform 0.3s ease;\n}\n\n.back-button:hover svg {\n  transform: translateX(-3px);\n}\n\n.thread-post {\n  margin-bottom: 2rem;\n}\n\n.comments-section {\n  background-color: var(--color-panel);\n  border-radius: 10px;\n  padding: 1.5rem;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  display: flex;\n  flex-direction: column;\n}\n\n.comments-section h3 {\n  margin-top: 0;\n  margin-bottom: 1.5rem;\n  font-size: 1.4rem;\n  font-weight: 600;\n  color: var(--color-input-text);\n  border-bottom: 1px solid var(--color-border);\n  padding-bottom: 0.8rem;\n}\n\n.comment-form {\n  margin-bottom: 2rem;\n}\n\n.form-group {\n  margin-bottom: 1rem;\n}\n\n.user-info {\n  display: flex;\n  align-items: center;\n  gap: 0.8rem;\n  margin-bottom: 0.8rem;\n}\n\n.user-info img {\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  object-fit: cover;\n  border: 2px solid var(--color-rose);\n}\n\n.user-info span {\n  font-weight: 600;\n  color: var(--color-input-text);\n  font-size: 0.95rem;\n}\n\ntextarea {\n  width: 95%;\n  min-height: 100px;\n  padding: 1rem;\n  background-color: var(--color-input-background);\n  border: 1px solid var(--color-border);\n  border-radius: 8px;\n  color: var(--color-input-text);\n  font-size: 0.95rem;\n  font-family: inherit;\n  resize: vertical;\n  transition: border-color 0.3s ease;\n}\n\ntextarea:focus {\n  outline: none;\n  border-color: var(--color-rose);\n  box-shadow: 0 0 0 2px rgba(191, 52, 103, 0.2);\n}\n\n.comment-btn {\n  background-color: var(--color-rose);\n  color: var(--color-primary-text);\n  border: none;\n  border-radius: 6px;\n  padding: 0.8rem 1.5rem;\n  font-size: 0.95rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: background-color 0.3s ease, transform 0.2s ease;\n  float: right;\n}\n\n.comment-btn:hover {\n  background-color: #9e2b53; /* un poco más oscuro que --color-rose para hover */\n  transform: translateY(-2px);\n}\n\n.login-to-comment {\n  background-color: var(--color-input-background);\n  padding: 1.5rem;\n  text-align: center;\n  border-radius: 8px;\n  margin-bottom: 2rem;\n}\n\n.login-to-comment p {\n  margin: 0;\n  color: var(--color-muted);\n  font-size: 1rem;\n}\n\n.comments-list {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n.no-comments {\n  padding: 2rem;\n  text-align: center;\n  border-radius: 8px;\n  background-color: var(--color-input-background);\n}\n\n.no-comments p {\n  margin: 0;\n  color: var(--color-muted);\n  font-size: 1rem;\n}\n\n.related-posts {\n  background-color: var(--color-panel);\n  border-radius: 10px;\n  padding: 1.5rem;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  height: fit-content;\n  position: sticky;\n  top: 100px;\n}\n\n.related-posts h3 {\n  margin-top: 0;\n  margin-bottom: 1.5rem;\n  font-size: 1.4rem;\n  font-weight: 600;\n  color: var(--color-input-text);\n  border-bottom: 1px solid var(--color-border);\n  padding-bottom: 0.8rem;\n}\n\n.related-posts p {\n  color: #7f88a0; /* un gris azulado intermedio */\n  font-style: italic;\n  text-align: center;\n  margin: 1.5rem 0;\n}\n\n@media (max-width: 992px) {\n  .thread-detail-container {\n    grid-template-columns: 1fr;\n  }\n\n  .related-posts {\n    display: none;\n  }\n}\n\n@media (max-width: 768px) {\n  .thread-detail-container {\n    padding: 80px 1rem 2rem;\n  }\n  \n  .comments-section {\n    padding: 1.2rem;\n  }\n  \n  .comments-section h3 {\n    font-size: 1.3rem;\n  }\n}\n\n@media (max-width: 480px) {\n  .comments-section {\n    padding: 1rem;\n  }\n  \n  .comments-section h3 {\n    font-size: 1.2rem;\n  }\n  \n  .user-info img {\n    width: 32px;\n    height: 32px;\n  }\n  \n  .comment-btn {\n    width: 100%;\n    padding: 0.7rem;\n  }\n  \n  textarea {\n    padding: 0.8rem;\n    font-size: 0.9rem;\n  }\n}\n"},3015:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.likeComment=t.getAllComments=t.addComment=t.savePost=t.likePost=t.getAllPosts=t.uploadPost=t.updateProfileInDatabase=void 0,t.registerWithSupa=async function(e,t,n){console.log("Attempting to register with email:",e);const r=e.trim(),s=t.trim(),{data:a,error:c}=await o.default.auth.signUp({email:r,password:s}),l=a?.user;return l&&i(l?.id,n.trim()),{user:l,error:c}},t.loginWithSupa=async function(e,t){const{data:n,error:r}=await o.default.auth.signInWithPassword({email:e,password:t}),s=n?.user,i=n?.session;let a=null;if(s){const{data:e,error:t}=await o.default.from("users").select("*").eq("id",s.id).single();t?console.error("Error fetching user profile:",t):a=e}return{user:s,userProfile:a,session:i,error:r}},t.uploadProfilePicture=async function(e){const t=e.name.replace(/[^a-zA-Z0-9.\-_]/g,""),n=`profile-pictures/${Date.now()}-${t}`,{error:r}=await o.default.storage.from("images").upload(n,e);if(r)throw r;const{data:s}=o.default.storage.from("images").getPublicUrl(n);return s.publicUrl},t.uploadPostPicture=async function(e){const t=e.name.replace(/[^a-zA-Z0-9.\-_]/g,""),n=`posts-pictures/${Date.now()}-${t}`,{error:r}=await o.default.storage.from("images").upload(n,e);if(r)throw r;const{data:s}=o.default.storage.from("images").getPublicUrl(n);return s.publicUrl};const s=n(7047),o=r(n(1256)),i=async(e,t)=>{const{data:n,error:r}=await o.default.from("users").insert([{id:e,username:t}]).single();return r&&console.error("Error registering user in database:",r),n};t.updateProfileInDatabase=async(e,t)=>{try{const{data:n,error:r}=await o.default.from("users").update({username:t.username,bio:t.bio,profilePicture:t.profilePicture}).eq("id",e).select().single();r?console.error("Error updating profile in database:",r):console.log("Profile updated successfully:",n)}catch(e){console.error("Error updating profile in database:",e)}},t.uploadPost=async e=>{const t=s.appState.get(),n={postId:function(){const e=BigInt(Math.floor(Math.random()*2**32))<<32n|BigInt(Math.floor(Math.random()*2**32));return Math.random()<.5?e:-e}().toString(),content:e.content,imageUrl:e.url,timestamp:(new Date).toISOString(),userId:t.currentUser?.id||"",likes:null,comments:0,reposts:0,saves:null,gameId:e.gameId||void 0},{data:r,error:i}=await o.default.from("posts").insert([n]).select().single();if(i)throw console.error("Error uploading post:",i),i;console.log("Post uploaded successfully:",r)},t.getAllPosts=async e=>{const{data:t,error:n}=await o.default.from("posts").select("\n    *,\n    users (\n      username,\n      profilePicture\n    )\n  ").order("timestamp",{ascending:!1});if(n)throw console.error("Error fetching posts:",n),n;return console.log("Posts fetched successfully:",t[0]),t.map((t=>({id:t.postId,userId:t.userId,username:t.users.username,profilePicture:t.users.profilePicture||"https://i.pinimg.com/736x/9f/16/72/9f1672710cba6bcb0dfd93201c6d4c00.jpg",content:t.content,imageUrl:t.imageUrl||void 0,likes:t.likes?.length||0,reposts:t.reposts||0,comments:t.comments||0,saves:t.saves?.length||0,timestamp:t.timestamp,gameId:t.gameId||void 0,isLiked:t.likes?.includes(e)||!1,isSaved:t.saves?.includes(e)||!1})))},t.likePost=async(e,t)=>{const{data:n,error:r}=await o.default.from("posts").select("likes").eq("postId",e).single();if(r)throw r;let s=n.likes??[];s.includes(t)?s=s.filter((e=>e!==t)):s.push(t);const{data:i,error:a}=await o.default.from("posts").update({likes:s}).eq("postId",e).select().single();if(a)throw a;return i},t.savePost=async(e,t)=>{const{data:n,error:r}=await o.default.from("posts").select("saves").eq("postId",e).single();if(r)throw r;let s=n.saves??[];s.includes(t)?s=s.filter((e=>e!==t)):s.push(t);const{data:i,error:a}=await o.default.from("posts").update({saves:s}).eq("postId",e).select().single();if(a)throw a;return i},t.addComment=async(e,t)=>{const n=s.appState.get(),{data:r,error:i}=await o.default.from("comments").insert([{postId:e,comId:`c${Date.now()}`,userId:n.currentUser?.id||"guest",content:t,likes:null,timestamp:(new Date).toISOString()}]).select().single();if(i)throw console.error("Error adding comment:",i),i;console.log("Comment added successfully:",r);const{data:a,error:c}=await o.default.from("posts").select("comments").eq("postId",e).single();if(c)throw console.error("Error fetching post for comment count:",c),c;const l=a?.comments??0,{error:d}=await o.default.from("posts").update({comments:l+1}).eq("postId",e);if(d)throw console.error("Error updating post comment count:",d),d;console.log("Post comment count updated successfully")},t.getAllComments=async e=>{const{data:t,error:n}=await o.default.from("comments").select("\n    *,\n    users (\n      username,\n      profilePicture\n    )\n  ").order("timestamp",{ascending:!1});if(n)throw console.error("Error fetching comments:",n),n;return t.map((t=>({id:t.comId,postId:t.postId,userId:t.userId,username:t.users.username,profilePicture:t.users.profilePicture||"https://i.pinimg.com/736x/9f/16/72/9f1672710cba6bcb0dfd93201c6d4c00.jpg",content:t.content,likes:t.likes?.length||0,timestamp:t.timestamp,isLiked:t.likes?.includes(e)||!1})))},t.likeComment=async(e,t)=>{const{data:n,error:r}=await o.default.from("comments").select("likes").eq("comId",e).single();if(r)throw r;let s=n.likes??[];s.includes(t)?s=s.filter((e=>e!==t)):s.push(t);const{data:i,error:a}=await o.default.from("comments").update({likes:s}).eq("comId",e).select().single();if(a)throw a;console.log("Comment liked/unliked successfully:",i)}},3061:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=":host {\n  display: block;\n  font-family: 'Inter', sans-serif;\n}\n\n.profile-container {\n  min-height: 100vh;\n  padding: 70px 0 2rem;\n  background-color: var(--color-background);\n  color: #e0e0e0;\n}\n\n.profile-header {\n  position: relative;\n  margin-bottom: 2rem;\n}\n\n.profile-cover {\n  height: 200px;\n  width: 100%;\n  background: linear-gradient(to right, var(--color-rose), #673ab7);\n  position: relative;\n  overflow: hidden;\n}\n\n.profile-cover::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: url('https://images.pexels.com/photos/3165335/pexels-photo-3165335.jpeg') no-repeat center;\n  background-size: cover;\n  opacity: 0.2;\n  mix-blend-mode: overlay;\n}\n\n.profile-info {\n  max-width: 900px;\n  margin: -80px auto 0;\n  padding: 0 2rem;\n  position: relative;\n  z-index: 10;\n  text-align: center;\n}\n\n.profile-picture {\n  width: 150px;\n  height: 150px;\n  border-radius: 50%;\n  border: 5px solid #121212;\n  object-fit: cover;\n  margin-bottom: 1rem;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);\n  transition: transform 0.3s ease;\n}\n\n.profile-picture:hover {\n  transform: scale(1.05);\n}\n\n.username {\n  font-size: 2rem;\n  font-weight: 700;\n  margin: 0 0 0.5rem;\n  color: #fff;\n}\n\n.bio {\n  color: #bdbdbd;\n  font-size: 1rem;\n  max-width: 500px;\n  margin: 0 auto 1.5rem;\n  line-height: 1.5;\n}\n\n.stats {\n  display: flex;\n  justify-content: center;\n  gap: 2rem;\n  margin-bottom: 1.5rem;\n}\n\n.stat {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n\n.value {\n  font-size: 1.5rem;\n  font-weight: 700;\n  color: #e0e0e0;\n}\n\n.label {\n  font-size: 0.9rem;\n  color: #9e9e9e;\n}\n\n.edit-profile-btn {\n  background-color: transparent;\n  color: var(--color-rose);\n  border: 2px solid var(--color-rose);\n  border-radius: 6px;\n  padding: 0.7rem 1.5rem;\n  font-size: 0.95rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n\n.edit-profile-btn:hover {\n  background-color: rgba(191, 52, 103, 0.1); /* var(--color-rose) rgba */\n  transform: translateY(-2px);\n}\n\n.profile-content {\n  max-width: 900px;\n  margin: 0 auto;\n  padding: 0 2rem;\n}\n\n.tabs {\n  display: flex;\n  background-color:var(--color-panel);\n  border-radius: 8px;\n  margin-bottom: 2rem;\n  overflow: hidden;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.tab-item {\n  flex: 1;\n  padding: 1rem 0;\n  text-align: center;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  border-bottom: 3px solid transparent;\n  color: #bdbdbd;\n}\n\n.tab-item:hover {\n  background-color: rgba(191, 52, 103, 0.1);\n  color: #e0e0e0;\n}\n\n.tab-item.active {\n  color: var(--color-rose);\n  border-bottom-color: var(--color-rose);\n  background-color: rgba(191, 52, 103, 0.05);\n}\n\n.tab-contents {\n  position: relative;\n}\n\n.tab-content {\n  display: none;\n  opacity: 0;\n  transform: translateY(20px);\n  transition: all 0.5s ease;\n}\n\n.tab-content.active {\n  display: block;\n  opacity: 1;\n  transform: translateY(0);\n  animation: fadeInUp 0.5s ease;\n}\n\n@keyframes fadeInUp {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.empty-message {\n  text-align: center;\n  padding: 3rem;\n  background-color:var(--color-panel);\n  border-radius: 8px;\n  color: #9e9e9e;\n  font-size: 1.1rem;\n}\n\n.games-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  gap: 1.5rem;\n}\n\n.stats-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));\n  gap: 1.5rem;\n}\n\n.stat-card {\n  background-color: #1e1e1e;\n  padding: 1.5rem;\n  border-radius: 8px;\n  text-align: center;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  transition: transform 0.3s ease;\n}\n\n.stat-card:hover {\n  transform: translateY(-5px);\n}\n\n.stat-card .stat-value {\n  font-size: 2.5rem;\n  font-weight: 700;\n  color: var(--color-rose);\n  margin-bottom: 0.5rem;\n}\n\n.stat-card .stat-label {\n  font-size: 1rem;\n  color: #bdbdbd;\n}\n\n.login-required {\n  text-align: center;\n  padding: 5rem 2rem;\n  background-color: #1a1a1a;\n  border-radius: 10px;\n  max-width: 500px;\n  margin: 3rem auto;\n  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);\n}\n\n.login-required h2 {\n  font-size: 2rem;\n  margin-bottom: 1rem;\n  color: #e0e0e0;\n}\n\n.login-required p {\n  color: #bdbdbd;\n  margin-bottom: 2rem;\n  font-size: 1.1rem;\n}\n\n.login-btn {\n  background-color: var(--color-rose);\n  color: white;\n  border: none;\n  border-radius: 6px;\n  padding: 1rem 2rem;\n  font-size: 1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n\n.login-btn:hover {\n  background-color: #9e2e56; /* un poco más oscuro que color-rose */\n  transform: translateY(-2px);\n  box-shadow: 0 4px 12px rgba(191, 52, 103, 0.3);\n}\n\n@media (max-width: 768px) {\n  .profile-cover {\n    height: 150px;\n  }\n\n  .profile-info {\n    margin-top: -65px;\n    padding: 0 1.5rem;\n  }\n\n  .profile-picture {\n    width: 120px;\n    height: 120px;\n  }\n\n  .username {\n    font-size: 1.8rem;\n  }\n\n  .bio {\n    font-size: 0.95rem;\n  }\n\n  .profile-content {\n    padding: 0 1.5rem;\n  }\n\n  .tabs {\n    border-radius: 6px;\n    margin-bottom: 1.5rem;\n  }\n\n  .tab-item {\n    padding: 0.8rem 0;\n    font-size: 0.9rem;\n  }\n\n  .games-grid {\n    grid-template-columns: repeat(2, 1fr);\n  }\n}\n\n@media (max-width: 480px) {\n  .profile-cover {\n    height: 120px;\n  }\n\n  .profile-info {\n    margin-top: -60px;\n    padding: 0 1rem;\n  }\n\n  .profile-picture {\n    width: 100px;\n    height: 100px;\n    border-width: 4px;\n  }\n\n  .username {\n    font-size: 1.6rem;\n  }\n\n  .bio {\n    font-size: 0.9rem;\n    margin-bottom: 1.2rem;\n  }\n\n  .stats {\n    gap: 1.5rem;\n  }\n\n  .value {\n    font-size: 1.3rem;\n  }\n\n  .edit-profile-btn {\n    padding: 0.6rem 1.2rem;\n    font-size: 0.9rem;\n  }\n\n  .profile-content {\n    padding: 0 1rem;\n  }\n\n  .tabs {\n    flex-wrap: nowrap;\n    overflow-x: auto;\n  }\n\n  .tab-item {\n    padding: 0.7rem 0.5rem;\n    font-size: 0.85rem;\n    white-space: nowrap;\n  }\n\n  .games-grid {\n    grid-template-columns: 1fr;\n  }\n\n  .stats-grid {\n    grid-template-columns: 1fr;\n  }\n\n  .login-required {\n    padding: 3rem 1.5rem;\n  }\n\n  .login-required h2 {\n    font-size: 1.8rem;\n  }\n\n  .login-required p {\n    font-size: 1rem;\n  }\n\n  .login-btn {\n    padding: 0.8rem 1.5rem;\n  }\n}\n"},3326:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=':host {\n  display: block;\n  font-family: "Inter", sans-serif;\n}\n\n.create-post {\n  background-color: var(--color-panel);\n  border-radius: 8px;\n  padding: 1.5rem;\n  margin-bottom: 2rem;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.create-post-header {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  margin-bottom: 1rem;\n}\n\n.user-avatar {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  object-fit: cover;\n  border: 2px solid var(--color-rose);\n}\n\n.post-form {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n}\n\n.input-group {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\ntextarea {\n  width: 100%;\n  min-height: 100px;\n  padding: 1rem;\n  background-color: var(--color-dark);\n  border: 1px solid var(--color-secondary);\n  border-radius: 8px;\n  color: var(--color-text-primary);\n  font-size: 0.95rem;\n  font-family: inherit;\n  resize: vertical;\n  transition: border-color 0.3s ease;\n}\n\ntextarea:focus {\n  outline: none;\n  border-color: var(--color-rose);\n}\n\ninput {\n  width: 100%;\n  padding: 0.8rem 1rem;\n  background-color: var(--color-dark);\n  border: 1px solid var(--color-secondary);\n  border-radius: 8px;\n  color: var(--color-text-primary);\n  font-size: 0.95rem;\n}\n\ninput:focus {\n  outline: none;\n  border-color: var(--color-rose);\n}\n\n.post-actions {\n  display: flex;\n  justify-content: flex-end;\n  gap: 1rem;\n  margin-top: 1rem;\n}\n\n.post-button {\n  padding: 0.8rem 1.5rem;\n  font-size: 0.95rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  border-radius: 6px;\n}\n\n.post-button.primary {\n  background-color: var(--color-rose);\n  color: var(--color-white);\n  border: none;\n}\n\n.post-button.primary:hover {\n  opacity: 0.9;\n  transform: translateY(-2px);\n}\n\n.post-button.secondary {\n  background-color: transparent;\n  color: var(--color-text-secondary);\n  border: 1px solid var(--color-secondary);\n}\n\n.post-button.secondary:hover {\n  background-color: rgba(255, 255, 255, 0.1);\n}\n\n.login-prompt {\n  text-align: center;\n  padding: 2rem;\n  color: var(--color-text-secondary);\n}\n\n.login-prompt a {\n  color: var(--color-rose);\n  text-decoration: none;\n  font-weight: 600;\n  cursor: pointer;\n}\n\n.login-prompt a:hover {\n  text-decoration: underline;\n}\n\nselect {\n  width: 100%;\n  padding: 0.8rem 1rem;\n  background-color: var(--color-dark);\n  border: 1px solid var(--color-secondary);\n  border-radius: 8px;\n  color: var(--color-rose);\n  font-size: 0.95rem;\n}\n\nselect:focus {\n  outline: none;\n  border-color: var(--color-rose);\n}\n\n.custom-file-upload svg {\n  stroke: var(--color-rose);\n}\n\n.optional-wrapper {\n  display: flex;\n  align-items: flex-start;\n  gap: 0.5rem;\n  font-size: 0.9rem;\n  width: 100%;\n}\n\n.optional-wrapper .image {\n  width: 30%;\n  height: 120px;\n  cursor: pointer;\n  background-color: transparent;\n  color: white;\n  border: 2px solid var(--color-rose);\n  border-radius: 8px;\n  font-family: sans-serif;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: center;\n}\n\n.optional-wrapper .image:hover {\n  background-color: rgba(191, 52, 103, 0.1);\n}\n\n.custom-file-upload input[type="file"] {\n  display: none;\n}\n\n.custom-file-upload {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.optional-wrapper .game {\n  width: 60%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n}\n\n#game-input {\n  border-bottom: solid 1px var(--color-rose);\n}\n\n#game-suggestions {\n  background: var(--color-panel);\n  border-top: none;\n  list-style: none;\n  padding: 0;\n  margin: 0;\n}\n\n.suggestion-item {\n  padding: 8px 10px;\n  cursor: pointer;\n  color: white;\n}\n\n.suggestion-item:hover {\n  background-color: rgba(191, 52, 103, 0.1);\n}\n'},3513:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=":host {\n  /* Your variables */\n\n  display: block;\n  font-family: 'Inter', sans-serif;\n}\n\n.landing-container {\n  min-height: 100vh;\n  padding-top: 70px;\n  background-color: var(--color-background);\n  color: var(--color-input-text);\n}\n\n/* Hero Section */\n.hero {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  min-height: 500px;\n  padding: 3rem max(2rem, calc((100% - 1200px) / 2));\n  background: linear-gradient(to right, rgba(11, 14, 23, 0.9), rgba(11, 14, 23, 0.7)),\n              url('https://images.pexels.com/photos/3165335/pexels-photo-3165335.jpeg') no-repeat center;\n  background-size: cover;\n  position: relative;\n}\n\n.hero-content {\n  max-width: 600px;\n  z-index: 2;\n  animation: fadeInUp 1s ease;\n}\n\n@keyframes fadeInUp {\n  from {\n    opacity: 0;\n    transform: translateY(30px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n.hero-title {\n  font-size: 4rem;\n  font-weight: 800;\n  margin-bottom: 1rem;\n  color: var(--color-primary-text);\n  text-shadow: 0 0 20px var(--color-link);\n}\n\n.hero-subtitle {\n  font-size: 1.5rem;\n  margin-bottom: 2rem;\n  color: var(--color-input-text);\n  line-height: 1.4;\n}\n\n.explore-btn {\n  background-color: var(--color-rose);\n  color: var(--color-primary-text);\n  border: none;\n  border-radius: 6px;\n  padding: 1rem 2rem;\n  font-size: 1.1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  position: relative;\n  overflow: hidden;\n}\n\n.explore-btn:before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.2), transparent);\n  transform: translateX(-100%);\n}\n\n.explore-btn:hover {\n  background-color: var(--color-rose);\n  transform: translateY(-3px);\n  box-shadow: 0 6px 15px rgba(191, 52, 103, 0.3);\n}\n\n.explore-btn:hover:before {\n  animation: shimmer 1.5s infinite;\n}\n\n@keyframes shimmer {\n  100% {\n    transform: translateX(100%);\n  }\n}\n\n/* Section Styles */\nsection {\n  padding: 5rem max(2rem, calc((100% - 1200px) / 2));\n}\n\n.section-title {\n  font-size: 2.5rem;\n  font-weight: 700;\n  margin-bottom: 1.5rem;\n  text-align: center;\n  color: var(--color-primary-text);\n  position: relative;\n  padding-bottom: 1rem;\n}\n\n.section-title:after {\n  content: '';\n  position: absolute;\n  bottom: 0;\n  left: 50%;\n  transform: translateX(-50%);\n  width: 80px;\n  height: 4px;\n  background-color: var(--color-rose);\n  border-radius: 2px;\n}\n\n.section-description {\n  max-width: 800px;\n  margin: 0 auto 3rem;\n  text-align: center;\n  font-size: 1.1rem;\n  line-height: 1.6;\n  color: var(--color-muted);\n}\n\n/* Welcome Section */\n.welcome-section {\n  background-color: var(--color-panel);\n}\n\n.learn-more-btn {\n  background-color: transparent;\n  color:var(--color-rose);\n  border: 2px solid var(--color-rose);\n  border-radius: 6px;\n  padding: 0.8rem 1.5rem;\n  font-size: 1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  display: block;\n  margin: 2rem auto 0;\n}\n\n.learn-more-btn:hover {\n  background-color: rgba(191, 52, 103, 0.1); /* rose tint */\n  transform: translateY(-2px);\n}\n\n/* Threads Section */\n.threads-section {\n background-color: var(--color-background);\n  padding-bottom: 3rem;\n}\n\n.threads-grid {\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n  max-width: 800px;\n  margin: 0 auto;\n}\n\n.thread-item {\n  transition: transform 0.3s ease;\n}\n\n.thread-item:hover {\n  transform: translateY(-5px);\n}\n\n/* Top Games Section */\n.games-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n  gap: 2rem;\n  margin-top: 2rem;\n}\n\n.game-item {\n  transition: transform 0.3s ease;\n}\n\n.game-item:hover {\n  transform: translateY(-5px);\n}\n\n/* Features Section */\n.features-section {\n  background-color: var(--color-panel);\n}\n\n.features-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n  gap: 2rem;\n}\n\n.feature-card {\n  background-color: var(--color-input-background);\n  padding: 2rem;\n  border-radius: 10px;\n  text-align: center;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n  transition: transform 0.3s ease, box-shadow 0.3s ease;\n}\n\n.feature-card:hover {\n  transform: translateY(-5px);\n  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);\n}\n\n.feature-icon {\n  margin-bottom: 1.5rem;\n  color: var(--color-rose);\n}\n\n.feature-icon svg {\n  fill: none;\n  stroke: currentColor;\n  stroke-width: 1.5;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n}\n\n.feature-card h3 {\n  margin-top: 0;\n  margin-bottom: 1rem;\n  font-size: 1.3rem;\n  font-weight: 600;\n  color: var(--color-primary-text);\n}\n\n.feature-card p {\n  margin: 0;\n  color: var(--color-muted);\n  font-size: 0.95rem;\n  line-height: 1.5;\n}\n\n/* Modal */\n.modal {\n  display: none;\n  position: fixed;\n  z-index: 1100;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  overflow: auto;\n  background-color: rgba(11, 14, 23, 0.7); /* using color-background as base */\n  opacity: 0;\n  transition: opacity 0.3s ease;\n}\n\n.modal.active {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  opacity: 1;\n}\n\n.modal-content {\n  background-color: var(--color-panel);\n  margin: 1rem;\n  padding: 2rem;\n  border-radius: 10px;\n  max-width: 700px;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);\n  position: relative;\n  animation: modalIn 0.4s ease;\n}\n\n@keyframes modalIn {\n  from {\n    opacity: 0;\n    transform: scale(0.95);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n\n.modal-content h2 {\n  margin-top: 0;\n  color: var(--color-primary-text);\n  font-size: 1.8rem;\n  font-weight: 700;\n  margin-bottom: 1.5rem;\n}\n\n.modal-content h3 {\n  color: var(--color-primary-text);\n  font-size: 1.3rem;\n  margin-top: 1.5rem;\n  margin-bottom: 0.8rem;\n}\n\n.modal-content p {\n  color: var(--color-muted);\n  line-height: 1.6;\n  margin-bottom: 1rem;\n}\n\n.modal-content ul {\n  color: var(--color-muted);\n  padding-left: 1.5rem;\n  margin-bottom: 1.5rem;\n}\n\n.modal-content li {\n  margin-bottom: 0.5rem;\n  line-height: 1.5;\n}\n\n.close {\n  position: absolute;\n  top: 1rem;\n  right: 1rem;\n  color: var(--color-muted);\n  font-size: 1.8rem;\n  font-weight: bold;\n  cursor: pointer;\n  transition: color 0.3s ease;\n}\n\n.close:hover {\n  color: var(--color-link);\n}\n\n.modal-btn {\n  background-color: var(--color-link);\n  color: var(--color-primary-text);\n  border: none;\n  border-radius: 6px;\n  padding: 0.8rem 2rem;\n  font-size: 1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  display: block;\n  margin: 2rem auto 0;\n}\n\n.modal-btn:hover {\n  background-color: var(--color-rose);\n  transform: translateY(-2px);\n}\n\n/* Responsive */\n@media (max-width: 992px) {\n  .hero-title {\n    font-size: 3.5rem;\n  }\n\n  .hero-subtitle {\n    font-size: 1.3rem;\n  }\n\n  .section-title {\n    font-size: 2.2rem;\n  }\n  \n  .section-description {\n    font-size: 1rem;\n  }\n}\n\n@media (max-width: 768px) {\n  .hero {\n    flex-direction: column;\n    padding: 2rem 1.5rem;\n    text-align: center;\n  }\n\n  .hero-title {\n    font-size: 3rem;\n  }\n\n  .hero-subtitle {\n    font-size: 1.2rem;\n  }\n\n  .hero-content {\n    max-width: 100%;\n    margin-bottom: 2rem;\n  }\n\n  section {\n    padding: 3rem 1.5rem;\n  }\n\n  .section-title {\n    font-size: 2rem;\n  }\n  \n  .section-description {\n    font-size: 0.95rem;\n    margin-bottom: 2rem;\n  }\n  \n  .features-grid {\n    grid-template-columns: 1fr;\n    gap: 1.5rem;\n  }\n}\n\n@media (max-width: 480px) {\n  .hero-title {\n    font-size: 2.5rem;\n  }\n  \n  .hero-subtitle {\n    font-size: 1.1rem;\n  }\n  \n  .explore-btn {\n    padding: 0.8rem 1.6rem;\n    font-size: 1rem;\n  }\n  \n  .section-title {\n    font-size: 1.8rem;\n  }\n  \n  .modal-content {\n    padding: 1.5rem;\n  }\n  \n  .modal-content h2 {\n    font-size: 1.5rem;\n  }\n  \n  .modal-content h3 {\n    font-size: 1.2rem;\n  }\n}\n"},3530:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;const r=n(4519);t.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${r.version}`}},3746:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GameAttributes=void 0;const s=n(6646),o=n(9006),i=r(n(304));var a;!function(e){e.ID="gameid",e.TITLE="title",e.CATEGORY="category",e.IMAGE_URL="imageurl",e.RATING="rating"}(a||(t.GameAttributes=a={}));class c extends HTMLElement{gameid;title="";category;imageurl;rating;static get observedAttributes(){return Object.values(a)}attributeChangedCallback(e,t,n){t!==n&&(e!==a.ID&&e!==a.TITLE&&e!==a.CATEGORY&&e!==a.IMAGE_URL&&e!==a.RATING||(this[e]=n))}constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render(),this.shadowRoot?.querySelector(".game-card")?.addEventListener("click",(()=>{this.category&&(0,s.navigate)(o.Screens.CATEGORIES,void 0,this.category)}))}generateStars(e){if(!e)return"";const t=parseFloat(e);let n="";for(let e=1;e<=5;e++)n+=e<=t?'<span class="star filled">★</span>':e-.5<=t?'<span class="star half">★</span>':'<span class="star">★</span>';return n}render(){this.shadowRoot&&(this.shadowRoot.innerHTML=`\n        <style>${i.default}</style> \x3c!-- Aplicamos los estilos --\x3e\n        <div class="game-card">\n          <div class="game-image-container">\n            <img src="${this.imageurl}" alt="${this.title}" class="game-image"> \x3c!-- Imagen del juego --\x3e\n            <div class="game-overlay">\n              <span class="view-more">View Games</span> \x3c!-- Texto que aparece encima de la imagen --\x3e\n            </div>\n          </div>\n          <div class="game-info">\n            <h3 class="game-title">${this.title}</h3> \x3c!-- Título del juego --\x3e\n            <div class="game-meta">\n              <span class="game-category">${this.category}</span> \x3c!-- Categoría a la que pertenece --\x3e\n              <div class="game-rating">${this.generateStars(this.rating)}</div> \x3c!-- Las estrellas de rating --\x3e\n            </div>\n          </div>\n        </div>\n      `)}}t.default=c},3825:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(8261));class o extends s.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const n=Array.from(new Set(t)).map((e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:n,type:r}={}){let s="";"plain"===r?s="pl":"phrase"===r?s="ph":"websearch"===r&&(s="w");const o=void 0===n?"":`(${n})`;return this.url.searchParams.append(e,`${s}fts${o}.${t}`),this}match(e){return Object.entries(e).forEach((([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)})),this}not(e,t,n){return this.url.searchParams.append(e,`not.${t}.${n}`),this}or(e,{foreignTable:t,referencedTable:n=t}={}){const r=n?`${n}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,n){return this.url.searchParams.append(e,`${t}.${n}`),this}}t.default=o},3837:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.initCommentsLikeListener=t.initCommentsRealtimeListener=t.initPostUpdateListener=t.initPostsRealtimeListener=t.initUserRealtimeListener=void 0;const s=n(6646),o=r(n(1256));t.initUserRealtimeListener=e=>o.default.channel(`user-changes-${e}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"users",filter:`id=eq.${e}`},(e=>{console.log("User update detected:",e);const t={id:e.new.id,username:e.new.username,profilePicture:e.new.profilePicture||"https://i.pinimg.com/736x/9f/16/72/9f1672710cba6bcb0dfd93201c6d4c00.jpg",bio:e.new.bio||"",followers:e.new.followers||0,following:e.new.following||0,posts:e.new.posts||[]};(0,s.updateProfile)(t),console.log("Profile updated in Flux:",t)})).subscribe(),t.initPostsRealtimeListener=()=>o.default.channel("posts-changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"posts"},(async e=>{console.log("New post detected:",e);const t=e.new.userId,{data:n,error:r}=await o.default.from("users").select("username, profilePicture").eq("id",t).single();if(r)return void console.error("Failed to fetch user info for post:",r.message);const i={postId:e.new.postId,userId:e.new.userId,username:n.username,profilePicture:n.profilePicture||"https://i.pinimg.com/736x/9f/16/72/9f1672710cba6bcb0dfd93201c6d4c00.jpg",content:e.new.content,imageUrl:e.new.imageUrl||"",likes:e.new.likes||[],reposts:e.new.reposts||0,comments:e.new.comments||0,saves:e.new.saves||[],timestamp:e.new.timestamp,gameId:e.new.gameId||void 0};(0,s.updatePosts)(i)})).subscribe(),t.initPostUpdateListener=()=>o.default.channel("posts-updates").on("postgres_changes",{event:"UPDATE",schema:"public",table:"posts"},(async e=>{console.log("New post detected:",e);const t=e.new.userId,{data:n,error:r}=await o.default.from("users").select("username, profilePicture").eq("id",t).single();if(r)return void console.error("Failed to fetch user info for post:",r.message);const i={postId:e.new.postId,userId:e.new.userId,username:n.username,profilePicture:n.profilePicture||"https://i.pinimg.com/736x/9f/16/72/9f1672710cba6bcb0dfd93201c6d4c00.jpg",content:e.new.content,imageUrl:e.new.imageUrl||"",likes:e.new.likes||[],reposts:e.new.reposts||0,comments:e.new.comments||0,saves:e.new.saves||[],timestamp:e.new.timestamp,gameId:e.new.gameId||void 0};(0,s.updatePosts)(i)})).subscribe(),t.initCommentsRealtimeListener=()=>o.default.channel("comments-changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"comments"},(async e=>{console.log("New comment detected:",e);const t=e.new.userId,{data:n,error:r}=await o.default.from("users").select("username, profilePicture").eq("id",t).single();if(r)return void console.error("Failed to fetch user info for post:",r.message);const i={id:e.new.comId,postId:e.new.postId,userId:e.new.userId,username:n.username,profilePicture:n.profilePicture||"https://i.pinimg.com/736x/9f/16/72/9f1672710cba6bcb0dfd93201c6d4c00.jpg",content:e.new.content,likes:e.new.likes||[],timestamp:e.new.timestamp};(0,s.updateComment)(i)})).subscribe(),t.initCommentsLikeListener=()=>o.default.channel("comments-changes-updates").on("postgres_changes",{event:"UPDATE",schema:"public",table:"comments"},(async e=>{console.log("New comment detected:",e);const t=e.new.userId,{data:n,error:r}=await o.default.from("users").select("username, profilePicture").eq("id",t).single();if(r)return void console.error("Failed to fetch user info for post:",r.message);const i={id:e.new.comId,postId:e.new.postId,userId:e.new.userId,username:n.username,profilePicture:n.profilePicture||"https://i.pinimg.com/736x/9f/16/72/9f1672710cba6bcb0dfd93201c6d4c00.jpg",content:e.new.content,likes:e.new.likes||[],timestamp:e.new.timestamp};(0,s.updateComment)(i)})).subscribe()},4157:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(7047),o=n(6646),i=n(9006);n(3746),n(4590);const a=r(n(3513));class c extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render();const e=this.shadowRoot?.querySelector("#explore-btn"),t=this.shadowRoot?.querySelector("#welcome-modal"),n=this.shadowRoot?.querySelector("#close-modal"),r=this.shadowRoot?.querySelector("#learn-more");e?.addEventListener("click",(()=>{(0,o.navigate)(i.Screens.THREADS)})),r?.addEventListener("click",(()=>{t?.classList.add("active"),document.body.style.overflow="hidden"})),n?.addEventListener("click",(()=>{t?.classList.remove("active"),document.body.style.overflow=""}))}renderTopGames(){return[...s.appState.get().games].sort(((e,t)=>t.rating-e.rating)).slice(0,4).map((e=>`\n      <div class="game-item">\n        <game-card\n          gameid="${e.id}"\n          title="${e.title}"\n          category="${e.category}"\n          imageurl="${e.imageUrl}"\n          rating="${e.rating}">\n        </game-card>\n      </div>\n    `)).join("")}renderRecentThreads(){return[...s.appState.get().posts].sort(((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime())).slice(0,4).map((e=>`\n      <div class="thread-item">\n        <post-card\n          postid="${e.id}"\n          userid="${e.userId}"\n          username="${e.username}"\n          pfp="${e.profilePicture}"\n          content="${e.content}"\n          ${e.imageUrl?`imageurl="${e.imageUrl}"`:""}\n          likes="${e.likes}"\n          reposts="${e.reposts}"\n          comments="${e.comments}"\n          saves="${e.saves}"\n          timestamp="${e.timestamp}"\n          ${e.gameId?`gameid="${e.gameId}"`:""}\n          preview="true">\n        </post-card>\n      </div>\n    `)).join("")}render(){if(this.shadowRoot){this.shadowRoot.innerHTML=`\n        <style>${a.default}</style>\n        \n        <div class="landing-container">\n          \x3c!-- Hero Section --\x3e\n          <section class="hero">\n            <div class="hero-content">\n              <h1 class="hero-title">Nexus</h1>\n              <p class="hero-subtitle">Connect with gamers. Share your passion.</p>\n              <button id="explore-btn" class="explore-btn">Explore Now</button>\n            </div>\n            <div class="hero-image"></div>\n          </section>\n          \n          \x3c!-- Welcome Section --\x3e\n          <section class="welcome-section">\n            <h2 class="section-title">Welcome to Nexus</h2>\n            <p class="section-description">\n              Nexus is a social platform dedicated to gamers, where you can share your gaming experiences, \n              discuss your favorite titles, and connect with fellow gamers from around the world.\n            </p>\n            <button id="learn-more" class="learn-more-btn">Learn More</button>\n          </section>\n          \n          \x3c!-- Top Games Section --\x3e\n          <section class="top-games-section">\n            <h2 class="section-title">Top Games</h2>\n            <p class="section-description">\n              Discover the most popular games in the community. Click on a game to see related posts.\n            </p>\n            <div class="games-grid">\n              ${this.renderTopGames()}\n            </div>\n          </section>\n          \n          \x3c!-- Features Section --\x3e\n          <section class="features-section">\n            <h2 class="section-title">Features</h2>\n            <div class="features-grid">\n              <div class="feature-card">\n                <div class="feature-icon">\n                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">\n                    <path d="M17 2H7a5 5 0 00-5 5v10a5 5 0 005 5h10a5 5 0 005-5V7a5 5 0 00-5-5zM7 4h10a3 3 0 013 3v10a3 3 0 01-3 3H7a3 3 0 01-3-3V7a3 3 0 013-3zm5 10a2 2 0 100-4 2 2 0 000 4z"/>\n                  </svg>\n                </div>\n                <h3>Share Posts</h3>\n                <p>Share your gaming experiences with the community through text and images.</p>\n              </div>\n              <div class="feature-card">\n                <div class="feature-icon">\n                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">\n                    <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>\n                  </svg>\n                </div>\n                <h3>Like & Comment</h3>\n                <p>Engage with content by liking, commenting, and saving your favorite posts.</p>\n              </div>\n              <div class="feature-card">\n                <div class="feature-icon">\n                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">\n                    <path d="M17 2H7a5 5 0 00-5 5v10a5 5 0 005 5h10a5 5 0 005-5V7a5 5 0 00-5-5z"/>\n                    <path d="M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37zM17.5 6.5h.01"/>\n                  </svg>\n                </div>\n                <h3>Discover Categories</h3>\n                <p>Browse content by game categories to find posts about your favorite games.</p>\n              </div>\n              <div class="feature-card">\n                <div class="feature-icon">\n                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="48" height="48">\n                    <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/>\n                    <circle cx="9" cy="7" r="4"/>\n                    <path d="M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/>\n                  </svg>\n                </div>\n                <h3>Build Community</h3>\n                <p>Connect with other gamers, follow your favorites, and join gaming discussions.</p>\n              </div>\n            </div>\n          </section>\n        </div>\n\n        \x3c!-- Recent Threads Section --\x3e\n          <section class="threads-section">\n            <h2 class="section-title">Recent Discussions</h2>\n            <p class="section-description">\n              Join the conversation and see what other gamers are talking about.\n            </p>\n            <div class="threads-grid">\n              ${this.renderRecentThreads()}\n            </div>\n          </section>\n        \n        \x3c!-- Welcome Modal --\x3e\n        <div id="welcome-modal" class="modal">\n          <div class="modal-content">\n            <span id="close-modal" class="close">&times;</span>\n            <h2>Welcome to Nexus - The Gaming Community</h2>\n            <p>\n              Nexus is designed from the ground up to connect gamers from all around the world. \n              Our platform allows you to share your gaming moments, discuss strategies, \n              and discover new titles based on the community's recommendations.\n            </p>\n            <h3>Our Mission</h3>\n            <p>\n              We believe gaming is more fun when shared with others. Our mission is to create\n              a positive space where gamers can connect, share, and grow together.\n            </p>\n            <h3>Key Features</h3>\n            <ul>\n              <li>Interactive posts with likes, comments, and saves</li>\n              <li>Game categorization for easy discovery</li>\n              <li>Community discussions on popular titles</li>\n              <li>Personal profile to showcase your gaming preferences</li>\n              <li>Responsive design that works on all your devices</li>\n            </ul>\n            <p>\n              Join Nexus today and become part of our growing community of passionate gamers!\n            </p>\n            <button id="close-btn" class="modal-btn">Got it!</button>\n          </div>\n        </div>\n      `;const e=this.shadowRoot.querySelector("#close-btn"),t=this.shadowRoot.querySelector("#welcome-modal");e?.addEventListener("click",(()=>{t?.classList.remove("active"),document.body.style.overflow=""}))}}disconnectedCallback(){}}t.default=c},4279:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(907)),o=r(n(6818));t.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=s.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,n,r;let s=null,i=null,a=null,c=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(i="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const r=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),o=null===(n=e.headers.get("content-range"))||void 0===n?void 0:n.split("/");r&&o&&o.length>1&&(a=parseInt(o[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(i)&&(i.length>1?(s={code:"PGRST116",details:`Results contain ${i.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},i=null,a=null,c=406,l="Not Acceptable"):i=1===i.length?i[0]:null)}else{const t=await e.text();try{s=JSON.parse(t),Array.isArray(s)&&404===e.status&&(i=[],s=null,c=200,l="OK")}catch(n){404===e.status&&""===t?(c=204,l="No Content"):s={message:t}}if(s&&this.isMaybeSingle&&(null===(r=null==s?void 0:s.details)||void 0===r?void 0:r.includes("0 rows"))&&(s=null,c=200,l="OK"),s&&this.shouldThrowOnError)throw new o.default(s)}return{error:s,data:i,count:a,status:c,statusText:l}}));return this.shouldThrowOnError||(n=n.catch((e=>{var t,n,r;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(n=null==e?void 0:e.stack)&&void 0!==n?n:""}`,hint:"",code:`${null!==(r=null==e?void 0:e.code)&&void 0!==r?r:""}`},data:null,count:null,status:0,statusText:""}}))),n.then(e,t)}returns(){return this}overrideTypes(){return this}}},4519:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},4590:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostAttributes=void 0;const s=n(7047),o=n(6646),i=n(9006),a=r(n(7868)),c=n(3015);var l;!function(e){e.ID="postid",e.USER_ID="userid",e.USERNAME="username",e.PROFILE_PICTURE="pfp",e.CONTENT="content",e.IMAGE_URL="imageurl",e.LIKES="likes",e.REPOSTS="reposts",e.COMMENTS="comments",e.SAVES="saves",e.TIMESTAMP="timestamp",e.GAME_ID="gameid",e.IS_LIKED="isliked",e.IS_SAVED="issaved"}(l||(t.PostAttributes=l={}));class d extends HTMLElement{postid;userid;username;pfp;content;imageurl;likes;reposts;comments;saves;timestamp;gameid;isliked;issaved;static get observedAttributes(){return Object.values(l)}attributeChangedCallback(e,t,n){t!==n&&(this[e]=n)}constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render();const e=this.shadowRoot?.querySelector(".post-content"),t=this.shadowRoot?.querySelector(".like-btn"),n=this.shadowRoot?.querySelector(".save-btn"),r=this.shadowRoot?.querySelector(".comment-btn"),a=s.appState.get();e?.addEventListener("click",(()=>{this.postid&&((0,o.navigate)(i.Screens.THREAD_DETAIL,this.postid),console.log("navigate from post"))})),t?.addEventListener("click",(e=>{e.stopPropagation(),this.postid&&a.isAuthenticated&&a.currentUser?(0,c.likePost)(this.postid,a.currentUser.id):s.appState.get().isAuthenticated||(0,o.navigate)(i.Screens.LOGIN)})),n?.addEventListener("click",(e=>{e.stopPropagation(),this.postid&&a.isAuthenticated&&a.currentUser?(0,c.savePost)(this.postid,a.currentUser.id):s.appState.get().isAuthenticated||(0,o.navigate)(i.Screens.LOGIN)})),r?.addEventListener("click",(e=>{e.stopPropagation(),this.postid&&(0,o.navigate)(i.Screens.THREAD_DETAIL,this.postid)}))}formatDate(e){if(!e)return"";const t=new Date(e),n=new Date,r=Math.floor((n.getTime()-t.getTime())/1e3);return r<60?`${r}s ago`:r<3600?`${Math.floor(r/60)}m ago`:r<86400?`${Math.floor(r/3600)}h ago`:t.toLocaleDateString()}render(){const e=s.appState.get(),t=e.posts.find((e=>e.id===this.postid)),n=e.games.find((e=>e.id===this.gameid)),r=t?.isLiked||"true"===this.isliked,o=t?.isSaved||"true"===this.issaved;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n        <style>${a.default}</style>\n        <div class="post-card">\n          <div class="post-header">\n            <img class="profile-picture" src="${this.pfp}" alt="${this.username}">\n            <div class="post-info">\n              <h3 class="username">${this.username}</h3>\n              <span class="timestamp">${this.formatDate(this.timestamp)}</span>\n            </div>\n          </div>\n\n          <div class="post-content">\n            <p class="content-text">${this.content}</p>\n            \n\n            ${this.imageurl?`<img class="content-image" src="${this.imageurl}" alt="Post image">`:""}\n\n            ${this.gameid&&`\n              <div class="game-tag">\n              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">\n              <path d="M2 12a10 10 0 0 1 20 0c0 3.87-2.29 7.21-5.59 8.73-.66.3-1.41-.1-1.41-.82v-.26c0-.46-.25-.87-.66-1.09a4.002 4.002 0 0 0-4.68 0c-.4.22-.66.63-.66 1.09v.26c0 .72-.75 1.12-1.41.82A9.996 9.996 0 0 1 2 12zm6-1a1 1 0 1 0 0 2H9v1a1 1 0 1 0 2 0v-1h1a1 1 0 1 0 0-2h-1V10a1 1 0 1 0-2 0v1H8zm8.5 1.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zm2 2a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z" fill="currentColor"/>\n              <small>${n?.title}</small>\n              </div>\n            </svg>\n              `}\n          </div>\n\n          <div class="post-actions">\n            <div class="action-btn like-btn ${r?"active":""}">\n              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">\n                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>\n              </svg>\n              <span>${this.likes}</span>\n            </div>\n            <div class="action-btn comment-btn">\n              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">\n                <path d="M21 11.5a8.38 8.38 0 01-.9 3.8 8.5 8.5 0 01-7.6 4.7 8.38 8.38 0 01-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 01-.9-3.8 8.5 8.5 0 014.7-7.6 8.38 8.38 0 013.8-.9h.5a8.48 8.48 0 018 8v.5z"/>\n              </svg>\n              <span>${this.comments}</span>\n            </div>\n            <div class="action-btn save-btn ${o?"active":""}">\n              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="20" height="20">\n                <path d="M19 21l-7-5-7 5V5a2 2 0 012-2h10a2 2 0 012 2z"/>\n              </svg>\n              <span>${this.saves}</span>\n            </div>\n          </div>\n        </div>\n      `)}disconnectedCallback(){}}t.default=d},4613:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(6646),o=n(3015),i=n(9006),a=r(n(7933));class c extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render();const e=this.shadowRoot?.querySelector("form"),t=this.shadowRoot?.querySelector("#login-link");e?.addEventListener("submit",this.handleSubmit.bind(this)),t?.addEventListener("click",this.handleLoginClick.bind(this))}async handleSubmit(e){e.preventDefault();const t=new FormData(e.target),n=t.get("email"),r=t.get("username"),a=t.get("password");if(a===t.get("confirmPassword")){if(r&&n&&a)try{console.log("Attempting to register with email:",n);const{user:e,error:t}=await(0,o.registerWithSupa)(n,a,r);if(t){console.error("Registration error:",t);const e=t.message||"An error occurred during registration.",n=this.shadowRoot?.querySelector("#error");return void(n&&(n.textContent=e))}e&&(0,s.navigate)(i.Screens.LOGIN)}catch(e){console.error("Registration error:",e),alert("Failed to register. Please try again.")}}else alert("Passwords don't match!")}handleLoginClick(e){e.preventDefault();const t=new CustomEvent("login");this.dispatchEvent(t)}render(){this.shadowRoot&&(this.shadowRoot.innerHTML=`\n        <style>${a.default}</style> \x3c!-- Aplica estilos --\x3e\n        <div class="register-container">\n          <h2>Create Account</h2>\n          <form>\n            <div class="form-group">\n              <label for="username">Username</label>\n              <input type="text" id="username" name="username" required>\n            </div>\n            <div class="form-group">\n              <label for="email">Email</label>\n              <input type="email" id="email" name="email" required>\n            </div>\n            <div class="form-group">\n              <label for="password">Password</label>\n              <input type="password" id="password" name="password" required>\n            </div>\n            <div class="form-group">\n              <label for="confirm-password">Confirm Password</label>\n              <input type="password" id="confirm-password" name="confirmPassword" required>\n            </div>\n            <p id="error"></p>\n            <button type="submit" class="register-button">Create Account</button>\n          </form>\n          <p class="login-text">\n            Already have an account? <a href="#" id="login-link">Login</a>\n          </p>\n        </div>\n      `)}disconnectedCallback(){const e=this.shadowRoot?.querySelector("form"),t=this.shadowRoot?.querySelector("#login-link");e?.removeEventListener("submit",this.handleSubmit.bind(this)),t?.removeEventListener("click",this.handleLoginClick.bind(this))}}t.default=c},4734:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Category=void 0,function(e){e.ACTION="Action",e.ADVENTURE="Adventure",e.RPG="RPG",e.STRATEGY="Strategy",e.SPORTS="Sports",e.HORROR="Horror",e.RACING="Racing",e.FIGHTING="Fighting"}(n||(t.Category=n={}))},5045:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(3825));t.default=class{constructor(e,{headers:t={},schema:n,fetch:r}){this.url=e,this.headers=t,this.schema=n,this.fetch=r}select(e,{head:t=!1,count:n}={}){const r=t?"HEAD":"GET";let o=!1;const i=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!o?"":('"'===e&&(o=!o),e))).join("");return this.url.searchParams.set("select",i),n&&(this.headers.Prefer=`count=${n}`),new s.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:n=!0}={}){const r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),n||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new s.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:n=!1,count:r,defaultToNull:o=!0}={}){const i=[`resolution=${n?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),o||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new s.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),this.headers.Prefer=n.join(","),new s.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new s.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},5078:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r='.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(11, 14, 23, 0.8); /* --color-background with opacity */\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.modal {\n  background-color: var(--color-panel);\n  border-radius: 10px;\n  padding: 2rem;\n  width: 90%;\n  max-width: 500px;\n  box-shadow: 0 15px 30px rgba(11, 14, 23, 0.3);\n  position: relative;\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 2rem;\n}\n\n.modal-title {\n  font-size: 1.5rem;\n  font-weight: 600;\n  color: var(--color-input-text);\n  margin: 0;\n}\n\n.close-button {\n  background: none;\n  border: none;\n  color: var(--color-input-text);\n  font-size: 1.5rem;\n  cursor: pointer;\n  padding: 0.5rem;\n  transition: color 0.3s ease;\n}\n\n.close-button:hover {\n  color: var(--color-rose);\n}\n\n.form-group {\n  margin-bottom: 1.5rem;\n}\n\nlabel {\n  display: block;\n  margin-bottom: 0.5rem;\n  color: var(--color-input-text);\n  font-size: 0.9rem;\n  font-weight: 500;\n}\n\ninput,\ntextarea {\n  width: 100%;\n  padding: 0.8rem 1rem;\n  border: 2px solid var(--color-border);\n  background-color: var(--color-input-background);\n  color: var(--color-input-text);\n  border-radius: 6px;\n  font-size: 1rem;\n  font-family: inherit;\n  transition: border-color 0.3s ease, box-shadow 0.3s ease;\n}\n\ntextarea {\n  min-height: 100px;\n  resize: vertical;\n}\n\ninput:focus,\ntextarea:focus {\n  outline: none;\n  border-color: var(--color-rose);\n  box-shadow: 0 0 0 3px rgba(191, 52, 103, 0.2); /* --color-rose with opacity */\n}\n\n.save-button {\n  width: 100%;\n  padding: 1rem;\n  background-color: var(--color-rose);\n  color: var(--color-primary-text);\n  border: none;\n  border-radius: 6px;\n  font-size: 1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: background-color 0.3s ease, transform 0.2s ease;\n  margin-top: 1rem;\n}\n\n.save-button:hover {\n  background-color: #a62d57; /* This is a darker pink - could be replaced by a darker shade of --color-rose if you want */\n  transform: translateY(-2px);\n}\n\n.save-button:active {\n  transform: translateY(0);\n}\n\n.image-preview {\n  width: 100%;\n  height: 100px;\n  border-radius: 6px;\n  background-color: var(--color-panel);\n  padding: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.image-preview img {\n  height: 100%;\n  object-fit: cover;\n  border-radius: 6px;\n}\n\n.custom-file-upload {\n  display: inline-block;\n  padding: 10px 20px;\n  cursor: pointer;\n  background-color: transparent;\n  color: white;\n  border: 2px solid var(--color-rose);\n  font-weight: 600;\n  border-radius: 8px;\n  transition: background-color 0.3s ease;\n  font-family: sans-serif;\n}\n\n.custom-file-upload:hover {\n  background-color: rgba(191, 52, 103, 0.1); /* Light hover effect */\n}\n\n.custom-file-upload input[type="file"] {\n  display: none;\n}\n\n@media (max-width: 480px) {\n  .modal {\n    padding: 1.5rem;\n  }\n\n  .modal-title {\n    font-size: 1.3rem;\n  }\n\n  input,\n  textarea {\n    padding: 0.7rem 0.9rem;\n    font-size: 0.95rem;\n  }\n\n  .save-button {\n    padding: 0.8rem;\n  }\n}\n'},6646:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateComment=t.updatePosts=t.filterByCategory=t.updateProfile=t.logout=t.login=t.navigate=t.ActionTypes=void 0;const r=n(2697),s=n(7047);t.ActionTypes={NAVIGATE:"NAVIGATE",LOGIN:"LOGIN",LOGOUT:"LOGOUT",UPDATE_PROFILE:"UPDATE_PROFILE",FILTER_BY_CATEGORY:"FILTER_BY_CATEGORY",UPDATE_POSTS:"UPDATE_POSTS",UPDATE_COMMENTS:"UPDATE_COMMENTS"},t.navigate=(e,n,s)=>{r.AppDispatcher.dispatch({type:t.ActionTypes.NAVIGATE,payload:{screen:e,postId:n,category:s}})},t.login=e=>{r.AppDispatcher.dispatch({type:t.ActionTypes.LOGIN,payload:e})},t.logout=()=>{r.AppDispatcher.dispatch({type:t.ActionTypes.LOGOUT})},t.updateProfile=e=>{console.log(e.profilePicture);const n={id:e.id,username:e.username,profilePicture:e.profilePicture||"https://i.pinimg.com/736x/9f/16/72/9f1672710cba6bcb0dfd93201c6d4c00.jpg",bio:e.bio||"",followers:e.followers||0,following:e.following||0};r.AppDispatcher.dispatch({type:t.ActionTypes.UPDATE_PROFILE,payload:n})},t.filterByCategory=e=>{r.AppDispatcher.dispatch({type:t.ActionTypes.FILTER_BY_CATEGORY,payload:e})},t.updatePosts=e=>{const n=s.appState.get(),o={id:e.postId.toString(),content:e.content,imageUrl:e.imageUrl||void 0,likes:e.likes?.length||0,comments:e.comments,timestamp:e.timestamp,userId:e.userId,username:e.username,profilePicture:e.profilePicture,reposts:e.reposts,saves:e.saves?.length||0,gameId:e.gameId||void 0,isLiked:!!n.currentUser&&e.likes?.includes(n.currentUser.id),isSaved:!!n.currentUser&&e.saves?.includes(n.currentUser.id)};r.AppDispatcher.dispatch({type:t.ActionTypes.UPDATE_POSTS,payload:o})},t.updateComment=e=>{const n={id:e.id,postId:e.postId,userId:e.userId,username:e.username,profilePicture:e.profilePicture,content:e.content,likes:e.likes?.length||0,timestamp:e.timestamp,isLiked:e.likes?.includes(e.userId)||!1};r.AppDispatcher.dispatch({type:t.ActionTypes.UPDATE_COMMENTS,payload:n})}},6765:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(7047);n(4590),n(116);const o=r(n(217));class i extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render()}renderPosts(){const e=s.appState.get().filteredPosts;return 0===e.length?'\n        <div class="no-posts">\n          <p>No posts found. Be the first to create a post!</p>\n        </div>\n      ':e.map((e=>`\n      <post-card\n        postid="${e.id}"\n        userid="${e.userId}"\n        username="${e.username}"\n        pfp="${e.profilePicture}"\n        content="${e.content}"\n        ${e.imageUrl?`imageurl="${e.imageUrl}"`:""}\n        likes="${e.likes}"\n        reposts="${e.reposts}"\n        comments="${e.comments}"\n        saves="${e.saves}"\n        timestamp="${e.timestamp}"\n        ${e.gameId?`gameid="${e.gameId}"`:""}\n        isliked="${e.isLiked||!1}"\n        issaved="${e.isSaved||!1}">\n      </post-card>\n    `)).join("")}render(){this.shadowRoot&&(this.shadowRoot.innerHTML=`\n        <style>${o.default}</style>\n        <div class="threads-container">\n          <div class="threads-header">\n            <h2>Latest Threads</h2>\n            <p>Join the conversation and share your gaming experiences.</p>\n          </div>\n          \n          <create-post></create-post> \x3c!-- Formulario para crear nuevo post --\x3e\n          \n          <div class="threads-feed">\n            ${this.renderPosts()} \x3c!-- Lista de posts existentes --\x3e\n          </div>\n        </div>\n      `)}disconnectedCallback(){}}t.default=i},6818:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=n},7047:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.dispatch=t.appState=void 0;const r=n(2697),s=n(6646),o=n(2098),i=n(9006),a=n(3015),c=[i.Screens.LANDING,i.Screens.LOGIN,i.Screens.REGISTER],l=new class{_state;_listeners=[];constructor(){this._state={currentScreen:i.Screens.LANDING,currentUser:null,isAuthenticated:!1,currentPostId:null,currentCategoryFilter:null,posts:[],comments:[],games:[...o.games],filteredPosts:[],loading:!1},this._loadState().then((e=>{this._state=e,this._notifyListeners()})),r.AppDispatcher.register(this._handleActions.bind(this))}async _loadState(){const e=localStorage.getItem("nexusAppState"),t={currentScreen:i.Screens.LANDING,currentUser:null,isAuthenticated:!1,currentPostId:null,currentCategoryFilter:null,posts:[],comments:[],games:[...o.games],filteredPosts:[],loading:!1};if(e)try{const n=JSON.parse(e),r=await(0,a.getAllPosts)(n.currentUser?.id||"guest"),s=await(0,a.getAllComments)(n.currentUser?.id||null);return{...t,...n,posts:r||[],comments:s||[],filteredPosts:n.currentCategoryFilter?(r||t.posts).filter((e=>{const t=o.games.find((t=>t.id===e.gameId));return t&&t.category===n.currentCategoryFilter})):[...r||t.posts],currentUser:n.currentUser||null}}catch(e){console.error("Failed to parse saved state:",e)}return t}getState(){return this._state}subscribe(e){this._listeners.push(e),e(this._state)}unsubscribe(e){this._listeners=this._listeners.filter((t=>t!==e))}_notifyListeners(){const{currentScreen:e,currentUser:t,isAuthenticated:n,currentPostId:r,currentCategoryFilter:s}=this._state;localStorage.setItem("nexusAppState",JSON.stringify({currentScreen:e,currentUser:t,isAuthenticated:n,currentPostId:r,currentCategoryFilter:s}));for(const e of this._listeners)e(this._state)}_handleActions(e){switch(e.type){case s.ActionTypes.NAVIGATE:if(e.payload){const t=e.payload.screen;if(!c.includes(t)&&!this._state.isAuthenticated){this._state.currentScreen=i.Screens.LOGIN;break}this._state.currentScreen=t,this._state.currentPostId=e.payload.postId||this._state.currentPostId,this._state.currentCategoryFilter=e.payload.category||this._state.currentCategoryFilter}break;case s.ActionTypes.LOGIN:this._state.currentUser=e.payload,console.log(e.payload),this._state.isAuthenticated=!0,this._state.currentScreen=i.Screens.THREADS;break;case s.ActionTypes.LOGOUT:this._state.currentUser=null,this._state.isAuthenticated=!1,this._state.currentScreen=i.Screens.LANDING;break;case s.ActionTypes.UPDATE_PROFILE:this._state.currentUser&&e.payload&&(console.log(e.payload.profilePicture),this._state.currentUser={...this._state.currentUser,...e.payload});break;case s.ActionTypes.UPDATE_POSTS:"object"==typeof e.payload&&"id"in e.payload&&"content"in e.payload&&(console.log(e.payload.postId),this._state.posts.forEach((e=>{console.log("Current post:",e.id)})),this._state.posts.some((t=>t.id===e.payload.id))?(this._state.posts=this._state.posts.map((t=>t.id===e.payload.id?{...t,...e.payload}:t)),this._state.filteredPosts=this._state.currentCategoryFilter?this._state.posts.filter((e=>{const t=this._state.games.find((t=>t.id===e.gameId));return t&&t.category===this._state.currentCategoryFilter})):[...this._state.posts]):(this._state.posts=[e.payload,...this._state.posts],this._state.filteredPosts=this._state.currentCategoryFilter?this._state.posts.filter((e=>{const t=this._state.games.find((t=>t.id===e.gameId));return t&&t.category===this._state.currentCategoryFilter})):[...this._state.posts]));break;case s.ActionTypes.UPDATE_COMMENTS:if("object"==typeof e.payload&&"id"in e.payload&&"postId"in e.payload){const t=this._state.comments.some((t=>t.id===e.payload.id));this._state.comments=t?this._state.comments.map((t=>t.id===e.payload.id?{...t,...e.payload}:t)):[e.payload,...this._state.comments]}break;case s.ActionTypes.FILTER_BY_CATEGORY:this._state.currentCategoryFilter=e.payload,this._state.filteredPosts=e.payload?this._state.posts.filter((t=>{const n=this._state.games.find((e=>e.id===t.gameId));return n&&n.category===e.payload})):[...this._state.posts]}this._notifyListeners()}};t.appState={get:()=>l.getState(),subscribe:e=>l.subscribe(e),unsubscribe:e=>l.unsubscribe(e)},t.dispatch=e=>{r.AppDispatcher.dispatch(e)}},7180:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(7047);n(4590),n(9536);const o=r(n(2846)),i=n(6646),a=n(9006),c=n(3015);class l extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render();const e=this.shadowRoot?.querySelector("#comment-form");e?.addEventListener("submit",this.handleCommentSubmit.bind(this))}handleCommentSubmit(e){e.preventDefault();const t=s.appState.get();if(!t.currentPostId)return;const n=e.target,r=new FormData(n).get("comment-content");r.trim()&&((0,c.addComment)(t.currentPostId,r),n.reset(),this.render())}renderPost(){const e=s.appState.get();if(!e.currentPostId)return"";const t=e.posts.find((t=>t.id===e.currentPostId));return t?`\n      <div class="thread-post">\n        <post-card\n          postid="${t.id}"\n          userid="${t.userId}"\n          username="${t.username}"\n          pfp="${t.profilePicture}"\n          content="${t.content}"\n          ${t.imageUrl?`imageurl="${t.imageUrl}"`:""}\n          likes="${t.likes}"\n          reposts="${t.reposts}"\n          comments="${t.comments}"\n          saves="${t.saves}"\n          timestamp="${t.timestamp}"\n          ${t.gameId?`gameid="${t.gameId}"`:""}\n          isliked="${t.isLiked||!1}"\n          issaved="${t.isSaved||!1}">\n        </post-card>\n      </div>\n    `:"<p>Post not found</p>"}renderComments(){const e=s.appState.get();if(!e.currentPostId)return"";const t=e.comments.filter((t=>t.postId===e.currentPostId));return 0===t.length?'\n        <div class="no-comments">\n          <p>No comments yet. Be the first to comment!</p>\n        </div>\n      ':t.map((e=>`\n      <comment-card\n        commentid="${e.id}"\n        postid="${e.postId}"\n        userid="${e.userId}"\n        username="${e.username}"\n        pfp="${e.profilePicture}"\n        content="${e.content}"\n        likes="${e.likes}"\n        timestamp="${e.timestamp}">\n      </comment-card>\n    `)).join("")}renderCommentForm(){const e=s.appState.get();return e.isAuthenticated?`\n      <form id="comment-form" class="comment-form">\n        <div class="form-group">\n          <div class="user-info">\n            <img src="${e.currentUser?.profilePicture}" alt="${e.currentUser?.username}">\n            <span>${e.currentUser?.username}</span>\n          </div>\n          <textarea name="comment-content" placeholder="Add a comment..." required></textarea>\n        </div>\n        <button type="submit" class="comment-btn">Post Comment</button>\n      </form>\n    `:'\n        <div class="login-to-comment">\n          <p>Log in to leave a comment</p>\n        </div>\n      '}render(){if(this.shadowRoot){this.shadowRoot.innerHTML=`\n        <style>${o.default}</style>\n        <div class="thread-detail-container">\n          <div class="thread-content">\n            <div class="back-button">\n              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">\n                <path d="M19 12H5M12 19l-7-7 7-7"/>\n              </svg>\n              <span>Back to threads</span>\n            </div>\n\n            ${this.renderPost()}\n\n            <div class="comments-section">\n              <h3>Comments</h3>\n\n              ${this.renderCommentForm()}\n\n              <div class="comments-list">\n                ${this.renderComments()}\n              </div>\n            </div>\n          </div>\n\n          <div class="related-posts">\n            <h3>Related Posts</h3>\n            <p>Coming soon...</p>\n          </div>\n        </div>\n      `;const e=this.shadowRoot.querySelector(".back-button");e?.addEventListener("click",(()=>{(0,i.navigate)(a.Screens.THREADS)}))}}disconnectedCallback(){}}t.default=l},7392:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=":host {\n  display: block;\n  width: 100%;\n  font-family: 'Inter', sans-serif;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\nheader {\n  background-color: var(--color-panel);\n  padding: 1rem 2rem;\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  z-index: 1000;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);\n  transition: background-color 0.3s ease;\n}\n\n.header-container {\n  max-width: 1200px;\n  margin: 0 auto;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 70%;\n  padding-right: 38px;\n}\n\n.logo {\n  cursor: pointer;\n  transition: transform 0.3s ease;\n}\n\n.logo:hover {\n  transform: scale(1.05);\n}\n\n.logo h1 {\n  margin: 0;\n  color: var(--color-rose);\n  font-size: 1.8rem;\n  font-weight: 700;\n  letter-spacing: 1px;\n  text-transform: uppercase;\n  text-shadow: 0 0 10px rgba(106, 90, 205, 0.3);\n}\n\n.nav-links ul {\n  display: flex;\n  list-style: none;\n  margin: 0;\n  padding: 0;\n  gap: 2rem;\n}\n\n.nav-links a {\n  color: var(--color-input-text);\n  text-decoration: none;\n  font-size: 1rem;\n  font-weight: 500;\n  position: relative;\n  cursor: pointer;\n  transition: color 0.3s ease;\n  padding-bottom: 5px;\n}\n\n.nav-links a:hover {\n  color: var(--color-rose);\n}\n\n.nav-links a:after {\n  content: '';\n  position: absolute;\n  width: 0;\n  height: 2px;\n  bottom: 0;\n  left: 0;\n  background-color: var(--color-rose);\n  transition: width 0.3s ease;\n}\n\n.nav-links a:hover:after, .nav-links a.active:after {\n  width: 100%;\n}\n\n.nav-links a.active {\n  color: var(--color-rose);\n}\n\n.auth-section {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n\n.user-profile {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  cursor: pointer;\n  transition: opacity 0.3s ease;\n}\n\n.user-profile:hover {\n  opacity: 0.8;\n}\n\n.user-profile img {\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n  object-fit: cover;\n  border: 2px solid var(--color-rose);\n}\n\n.user-profile span {\n  color: var(--color-input-text);\n  font-size: 0.9rem;\n  font-weight: 500;\n}\n\n.login-btn, .logout-btn {\n  background-color: var(--color-rose);\n  color: var(--color-input-text);\n  border: none;\n  border-radius: 4px;\n  padding: 0.5rem 1rem;\n  font-size: 0.9rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: background-color 0.3s ease, transform 0.2s ease;\n}\n\n.login-btn:hover, .logout-btn:hover {\n  background-color: var(--color-rose);\n  transform: translateY(-2px);\n}\n\n.logout-btn {\n  background-color: transparent;\n  border: 1px solid var(--color-rose);\n}\n\n.logout-btn:hover {\n  background-color: rgba(106, 90, 205, 0.1);\n}\n\n.menu-toggle {\n  display: none;\n  flex-direction: column;\n  justify-content: space-between;\n  height: 20px;\n  width: 28px;\n  cursor: pointer;\n}\n\n.menu-toggle span {\n  display: block;\n  height: 3px;\n  width: 100%;\n  background-color: var(--color-input-text);\n  border-radius: 3px;\n  transition: all 0.3s ease;\n}\n\n.menu-toggle.active span:nth-child(1) {\n  transform: translateY(8px) rotate(45deg);\n}\n\n.menu-toggle.active span:nth-child(2) {\n  opacity: 0;\n}\n\n.menu-toggle.active span:nth-child(3) {\n  transform: translateY(-8px) rotate(-45deg);\n}\n\n@media (max-width: 768px) {\n  .menu-toggle {\n    display: flex;\n  }\n\n  .nav-links {\n    position: fixed;\n    top: 70px;\n    left: 0;\n    width: 100%;\n    background-color: var(--color-panel);\n    padding: 1rem;\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);\n    clip-path: circle(0px at top right);\n    transition: clip-path 0.5s ease;\n    z-index: 999;\n  }\n\n  .nav-links.active {\n    clip-path: circle(1000px at top right);\n  }\n\n  .nav-links ul {\n    flex-direction: column;\n    gap: 1.2rem;\n    padding: 1rem 0;\n  }\n\n  .nav-links li {\n    width: 100%;\n    text-align: center;\n  }\n\n  .nav-links a {\n    display: block;\n    padding: 0.5rem 1rem;\n    font-size: 1.1rem;\n  }\n\n  .nav-links a:after {\n    display: none;\n  }\n\n  .auth-section {\n    margin-right: 3rem;\n  }\n\n  .user-profile span {\n    display: none;\n  }\n}\n\n@media (max-width: 480px) {\n  header {\n    padding: 0.8rem 1rem;\n  }\n\n  .logo h1 {\n    font-size: 1.5rem;\n  }\n\n  .auth-section {\n    margin-right: 2rem;\n  }\n\n  .login-btn, .logout-btn {\n    padding: 0.4rem 0.8rem;\n    font-size: 0.8rem;\n  }\n}\n"},7470:(e,t,n)=>{n.r(t),n.d(t,{AuthAdminApi:()=>jt,AuthApiError:()=>Re,AuthClient:()=>Ot,AuthError:()=>Ce,AuthImplicitGrantRedirectError:()=>Ne,AuthInvalidCredentialsError:()=>Me,AuthInvalidJwtError:()=>Ye,AuthInvalidTokenResponseError:()=>De,AuthPKCEGrantCodeExchangeError:()=>Fe,AuthRetryableFetchError:()=>Ge,AuthSessionMissingError:()=>Ue,AuthUnknownError:()=>Oe,AuthWeakPasswordError:()=>Be,CustomAuthError:()=>Le,FunctionRegion:()=>a,FunctionsError:()=>r,FunctionsFetchError:()=>s,FunctionsHttpError:()=>i,FunctionsRelayError:()=>o,GoTrueAdminApi:()=>kt,GoTrueClient:()=>Rt,NavigatorLockAcquireTimeoutError:()=>At,PostgrestError:()=>g,REALTIME_CHANNEL_STATES:()=>G,REALTIME_LISTEN_TYPES:()=>N,REALTIME_POSTGRES_CHANGES_LISTEN_EVENT:()=>M,REALTIME_PRESENCE_LISTEN_EVENTS:()=>D,REALTIME_SUBSCRIBE_STATES:()=>q,RealtimeChannel:()=>H,RealtimeClient:()=>J,RealtimePresence:()=>F,SupabaseClient:()=>Ut,createClient:()=>zt,isAuthApiError:()=>je,isAuthError:()=>Ie,isAuthImplicitGrantRedirectError:()=>qe,isAuthRetryableFetchError:()=>He,isAuthSessionMissingError:()=>ze,isAuthWeakPasswordError:()=>Je,lockInternals:()=>Tt,navigatorLock:()=>$t});class r extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class s extends r{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class o extends r{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class i extends r{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var a;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(a||(a={}));class c{constructor(e,{headers:t={},customFetch:r,region:s=a.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(n.bind(n,907)).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)})(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var n,r,a,c,l;return r=this,a=void 0,l=function*(){try{const{headers:r,method:a,body:c}=t;let l,d={},{region:h}=t;h||(h=this.region),h&&"any"!==h&&(d["x-region"]=h),c&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!=typeof Blob&&c instanceof Blob||c instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",l=c):"string"==typeof c?(d["Content-Type"]="text/plain",l=c):"undefined"!=typeof FormData&&c instanceof FormData?l=c:(d["Content-Type"]="application/json",l=JSON.stringify(c)));const u=yield this.fetch(`${this.url}/${e}`,{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),r),body:l}).catch((e=>{throw new s(e)})),p=u.headers.get("x-relay-error");if(p&&"true"===p)throw new o(u);if(!u.ok)throw new i(u);let m,g=(null!==(n=u.headers.get("Content-Type"))&&void 0!==n?n:"text/plain").split(";")[0].trim();return m="application/json"===g?yield u.json():"application/octet-stream"===g?yield u.blob():"text/event-stream"===g?u:"multipart/form-data"===g?yield u.formData():yield u.text(),{data:m,error:null}}catch(e){return{data:null,error:e}}},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{o(l.next(e))}catch(e){t(e)}}function s(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){var r;t.done?e(t.value):(r=t.value,r instanceof c?r:new c((function(e){e(r)}))).then(n,s)}o((l=l.apply(r,a||[])).next())}))}}var l=n(2279);const{PostgrestClient:d,PostgrestQueryBuilder:h,PostgrestFilterBuilder:u,PostgrestTransformBuilder:p,PostgrestBuilder:m,PostgrestError:g}=l;let f;f="undefined"==typeof window?n(1591):window.WebSocket;const v=f,b={"X-Client-Info":"realtime-js/2.11.10"};var y,w,x,_,k,S;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(y||(y={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(w||(w={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(x||(x={})),function(e){e.websocket="websocket"}(_||(_={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(k||(k={}));class E{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const r=t.getUint8(1),s=t.getUint8(2);let o=this.HEADER_LENGTH+2;const i=n.decode(e.slice(o,o+r));o+=r;const a=n.decode(e.slice(o,o+s));return o+=s,{ref:null,topic:i,event:a,payload:JSON.parse(n.decode(e.slice(o,e.byteLength)))}}}class T{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(S||(S={}));const P=(e,t,n={})=>{var r;const s=null!==(r=n.skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce(((n,r)=>(n[r]=A(r,e,t,s),n)),{})},A=(e,t,n,r)=>{const s=t.find((t=>t.name===e)),o=null==s?void 0:s.type,i=n[e];return o&&!r.includes(o)?$(o,i):C(i)},$=(e,t)=>{if("_"===e.charAt(0)){const n=e.slice(1,e.length);return O(t,n)}switch(e){case S.bool:return I(t);case S.float4:case S.float8:case S.int2:case S.int4:case S.int8:case S.numeric:case S.oid:return R(t);case S.json:case S.jsonb:return j(t);case S.timestamp:return L(t);case S.abstime:case S.date:case S.daterange:case S.int4range:case S.int8range:case S.money:case S.reltime:case S.text:case S.time:case S.timestamptz:case S.timetz:case S.tsrange:case S.tstzrange:default:return C(t)}},C=e=>e,I=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},R=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},j=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},O=(e,t)=>{if("string"!=typeof e)return e;const n=e.length-1,r=e[n];if("{"===e[0]&&"}"===r){let r;const s=e.slice(1,n);try{r=JSON.parse("["+s+"]")}catch(e){r=s?s.split(","):[]}return r.map((e=>$(t,e)))}return e},L=e=>"string"==typeof e?e.replace(" ","T"):e,U=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class z{constructor(e,t,n={},r=1e4){this.channel=e,this.event=t,this.payload=n,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t(null===(n=this.receivedResp)||void 0===n?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout))}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter((t=>t.status===e)).forEach((e=>e.callback(t)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var D,M,N,q;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(D||(D={}));class F{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},(e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=F.syncState(this.state,e,t,n),this.pendingDiffs.forEach((e=>{this.state=F.syncDiff(this.state,e,t,n)})),this.pendingDiffs=[],r()})),this.channel._on(n.diff,{},(e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=F.syncDiff(this.state,e,t,n),r())})),this.onJoin(((e,t,n)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:n})})),this.onLeave(((e,t,n)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:n})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,n,r){const s=this.cloneDeep(e),o=this.transformState(t),i={},a={};return this.map(s,((e,t)=>{o[e]||(a[e]=t)})),this.map(o,((e,t)=>{const n=s[e];if(n){const r=t.map((e=>e.presence_ref)),s=n.map((e=>e.presence_ref)),o=t.filter((e=>s.indexOf(e.presence_ref)<0)),c=n.filter((e=>r.indexOf(e.presence_ref)<0));o.length>0&&(i[e]=o),c.length>0&&(a[e]=c)}else i[e]=t})),this.syncDiff(s,{joins:i,leaves:a},n,r)}static syncDiff(e,t,n,r){const{joins:s,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),r||(r=()=>{}),this.map(s,((t,r)=>{var s;const o=null!==(s=e[t])&&void 0!==s?s:[];if(e[t]=this.cloneDeep(r),o.length>0){const n=e[t].map((e=>e.presence_ref)),r=o.filter((e=>n.indexOf(e.presence_ref)<0));e[t].unshift(...r)}n(t,o,r)})),this.map(o,((t,n)=>{let s=e[t];if(!s)return;const o=n.map((e=>e.presence_ref));s=s.filter((e=>o.indexOf(e.presence_ref)<0)),e[t]=s,r(t,s,n),0===s.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((n=>t(n,e[n])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,n)=>{const r=e[n];return t[n]="metas"in r?r.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):r,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(M||(M={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(N||(N={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(q||(q={}));const G=w;class H{constructor(e,t={config:{}},n){this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=w.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new z(this,x.join,this.params,this.timeout),this.rejoinTimer=new T((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=w.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=w.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=w.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=w.errored,this.rejoinTimer.scheduleTimeout())})),this._on(x.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new F(this),this.broadcastEndpointURL=U(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var n,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:o,private:i}}=this.params;this._onError((t=>null==e?void 0:e(q.CHANNEL_ERROR,t))),this._onClose((()=>null==e?void 0:e(q.CLOSED)));const a={},c={broadcast:s,presence:o,postgres_changes:null!==(r=null===(n=this.bindings.postgres_changes)||void 0===n?void 0:n.map((e=>e.filter)))&&void 0!==r?r:[],private:i};this.socket.accessTokenValue&&(a.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},a)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async({postgres_changes:t})=>{var n;if(this.socket.setAuth(),void 0!==t){const r=this.bindings.postgres_changes,s=null!==(n=null==r?void 0:r.length)&&void 0!==n?n:0,o=[];for(let n=0;n<s;n++){const s=r[n],{filter:{event:i,schema:a,table:c,filter:l}}=s,d=t&&t[n];if(!d||d.event!==i||d.schema!==a||d.table!==c||d.filter!==l)return this.unsubscribe(),this.state=w.errored,void(null==e||e(q.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));o.push(Object.assign(Object.assign({},s),{id:d.id}))}return this.bindings.postgres_changes=o,void(e&&e(q.SUBSCRIBED))}null==e||e(q.SUBSCRIBED)})).receive("error",(t=>{this.state=w.errored,null==e||e(q.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null==e||e(q.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e,t={}){var n,r;if(this._canPush()||"broadcast"!==e.type)return new Promise((n=>{var r,s,o;const i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(o=null===(s=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===s?void 0:s.broadcast)||void 0===o?void 0:o.ack)||n("ok"),i.receive("ok",(()=>n("ok"))),i.receive("error",(()=>n("error"))),i.receive("timeout",(()=>n("timed out")))}));{const{event:s,payload:o}=e,i={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,i,null!==(n=t.timeout)&&void 0!==n?n:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(e){return"AbortError"===e.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=w.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(x.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise((n=>{const r=new z(this,x.leave,{},e);r.receive("ok",(()=>{t(),n("ok")})).receive("timeout",(()=>{t(),n("timed out")})).receive("error",(()=>{n("error")})),r.send(),this._canPush()||r.trigger("ok",{})}))}teardown(){this.pushBuffer.forEach((e=>e.destroy())),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(e,t,n){const r=new AbortController,s=setTimeout((()=>r.abort()),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(s),o}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new z(this,e,t,n);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var r,s;const o=e.toLocaleLowerCase(),{close:i,error:a,leave:c,join:l}=x;if(n&&[i,a,c,l].indexOf(o)>=0&&n!==this._joinRef())return;let d=this._onMessage(o,t,n);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter((e=>{var t,n,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(n=e.filter)||void 0===n?void 0:n.event)||void 0===r?void 0:r.toLocaleLowerCase())===o})).map((e=>e.callback(d,n))):null===(s=this.bindings[o])||void 0===s||s.filter((e=>{var n,r,s,i,a,c;if(["broadcast","presence","postgres_changes"].includes(o)){if("id"in e){const o=e.id,i=null===(n=e.filter)||void 0===n?void 0:n.event;return o&&(null===(r=t.ids)||void 0===r?void 0:r.includes(o))&&("*"===i||(null==i?void 0:i.toLocaleLowerCase())===(null===(s=t.data)||void 0===s?void 0:s.type.toLocaleLowerCase()))}{const n=null===(a=null===(i=null==e?void 0:e.filter)||void 0===i?void 0:i.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===n||n===(null===(c=null==t?void 0:t.event)||void 0===c?void 0:c.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===o})).map((e=>{if("object"==typeof d&&"ids"in d){const e=d.data,{schema:t,table:n,commit_timestamp:r,type:s,errors:o}=e,i={schema:t,table:n,commit_timestamp:r,eventType:s,new:{},old:{},errors:o};d=Object.assign(Object.assign({},i),this._getPayloadRecords(e))}e.callback(d,n)}))}_isClosed(){return this.state===w.closed}_isJoined(){return this.state===w.joined}_isJoining(){return this.state===w.joining}_isLeaving(){return this.state===w.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const r=e.toLocaleLowerCase(),s={type:r,filter:t,callback:n};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter((e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===n&&H.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(x.close,{},e)}_onError(e){this._on(x.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=w.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=P(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=P(e.columns,e.old_record)),t}}const B=()=>{};class J{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=b,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=B,this.ref=0,this.logger=B,this.conn=null,this.sendBuffer=[],this.serializer=new E,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(n.bind(n,907)).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},this.endPoint=`${e}/${_.websocket}`,this.httpEndpoint=U(e),(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),((null==t?void 0:t.logLevel)||(null==t?void 0:t.log_level))&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=null===(r=null==t?void 0:t.params)||void 0===r?void 0:r.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new T((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch),null==t?void 0:t.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null==t?void 0:t.worker)||!1,this.workerUrl=null==t?void 0:t.workerUrl}this.accessToken=(null==t?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=v),this.transport){const e="undefined"!=typeof window&&this.transport===window.WebSocket;return this.conn=e?new this.transport(this.endpointURL()):new this.transport(this.endpointURL(),void 0,{headers:this.headers}),void this.setupConnection()}this.conn=new Y(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach((e=>e.teardown())))}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels=this.channels.filter((t=>t._joinRef!==e._joinRef)),0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case y.connecting:return k.Connecting;case y.open:return k.Open;case y.closing:return k.Closing;default:return k.Closed}}isConnected(){return this.connectionState()===k.Open}channel(e,t={config:{}}){const n=`realtime:${e}`,r=this.getChannels().find((e=>e.topic===n));if(r)return r;{const n=new H(`realtime:${e}`,t,this);return this.channels.push(n),n}}push(e){const{topic:t,event:n,payload:r,ref:s}=e,o=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${n} (${s})`,r),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach((e=>{t&&e.updateJoinPayload({access_token:t,version:this.headers&&this.headers["X-Client-Info"]}),e.joinedOnce&&e._isJoined()&&e._push(x.access_token,{access_token:t})})))}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}else this.heartbeatCallback("disconnected")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t.topic!==e.topic))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:n,payload:r,ref:s}=e;"phoenix"===t&&"phx_reply"===n&&this.heartbeatCallback("ok"==e.payload.status?"ok":"error"),s&&s===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${n} ${s&&"("+s+")"||""}`,r),Array.from(this.channels).filter((e=>e._isMember(t))).forEach((e=>e._trigger(n,r,s))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(x.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const n=e.match(/\?/)?"&":"?";return`${e}${n}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class Y{constructor(e,t,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=y.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=n.close}}class K extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function V(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class W extends K{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class X extends K{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const Q=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(n.bind(n,907)).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},Z=e=>{if(Array.isArray(e))return e.map((e=>Z(e)));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((([e,n])=>{const r=e.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[r]=Z(n)})),t};var ee=function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))};const te=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ne=(e,t,r)=>ee(void 0,void 0,void 0,(function*(){const s=yield(o=void 0,i=void 0,a=void 0,c=function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(n.bind(n,907))).Response:Response},new(a||(a=Promise))((function(e,t){function n(e){try{s(c.next(e))}catch(e){t(e)}}function r(e){try{s(c.throw(e))}catch(e){t(e)}}function s(t){var s;t.done?e(t.value):(s=t.value,s instanceof a?s:new a((function(e){e(s)}))).then(n,r)}s((c=c.apply(o,i||[])).next())})));var o,i,a,c;e instanceof s&&!(null==r?void 0:r.noResolveJson)?e.json().then((n=>{t(new W(te(n),e.status||500))})).catch((e=>{t(new X(te(e),e))})):t(new X(te(e),e))}));function re(e,t,n,r,s,o){return ee(this,void 0,void 0,(function*(){return new Promise(((i,a)=>{e(n,((e,t,n,r)=>{const s={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?s:(s.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),r&&(s.body=JSON.stringify(r)),Object.assign(Object.assign({},s),n))})(t,r,s,o)).then((e=>{if(!e.ok)throw e;return(null==r?void 0:r.noResolveJson)?e:e.json()})).then((e=>i(e))).catch((e=>ne(e,a,r)))}))}))}function se(e,t,n,r){return ee(this,void 0,void 0,(function*(){return re(e,"GET",t,n,r)}))}function oe(e,t,n,r,s){return ee(this,void 0,void 0,(function*(){return re(e,"POST",t,r,s,n)}))}function ie(e,t,n,r,s){return ee(this,void 0,void 0,(function*(){return re(e,"DELETE",t,r,s,n)}))}var ae=function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))};const ce={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},le={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class de{constructor(e,t={},n,r){this.url=e,this.headers=t,this.bucketId=n,this.fetch=Q(r)}uploadOrUpdate(e,t,n,r){return ae(this,void 0,void 0,(function*(){try{let s;const o=Object.assign(Object.assign({},le),r);let i=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(o.upsert)});const a=o.metadata;"undefined"!=typeof Blob&&n instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),a&&s.append("metadata",this.encodeMetadata(a)),s.append("",n)):"undefined"!=typeof FormData&&n instanceof FormData?(s=n,s.append("cacheControl",o.cacheControl),a&&s.append("metadata",this.encodeMetadata(a))):(s=n,i["cache-control"]=`max-age=${o.cacheControl}`,i["content-type"]=o.contentType,a&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),(null==r?void 0:r.headers)&&(i=Object.assign(Object.assign({},i),r.headers));const c=this._removeEmptyFolders(t),l=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${l}`,Object.assign({method:e,body:s,headers:i},(null==o?void 0:o.duplex)?{duplex:o.duplex}:{})),h=yield d.json();return d.ok?{data:{path:c,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}upload(e,t,n){return ae(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,n)}))}uploadToSignedUrl(e,t,n,r){return ae(this,void 0,void 0,(function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),i=new URL(this.url+`/object/upload/sign/${o}`);i.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:le.upsert},r),o=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&n instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",n)):"undefined"!=typeof FormData&&n instanceof FormData?(e=n,e.append("cacheControl",t.cacheControl)):(e=n,o["cache-control"]=`max-age=${t.cacheControl}`,o["content-type"]=t.contentType);const a=yield this.fetch(i.toString(),{method:"PUT",body:e,headers:o}),c=yield a.json();return a.ok?{data:{path:s,fullPath:c.Key},error:null}:{data:null,error:c}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}createSignedUploadUrl(e,t){return ae(this,void 0,void 0,(function*(){try{let n=this._getFinalPath(e);const r=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(r["x-upsert"]="true");const s=yield oe(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:r}),o=new URL(this.url+s.url),i=o.searchParams.get("token");if(!i)throw new K("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:i},error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}update(e,t,n){return ae(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,n)}))}move(e,t,n){return ae(this,void 0,void 0,(function*(){try{return{data:yield oe(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==n?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}copy(e,t,n){return ae(this,void 0,void 0,(function*(){try{return{data:{path:(yield oe(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==n?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}createSignedUrl(e,t,n){return ae(this,void 0,void 0,(function*(){try{let r=this._getFinalPath(e),s=yield oe(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null==n?void 0:n.transform)?{transform:n.transform}:{}),{headers:this.headers});const o=(null==n?void 0:n.download)?`&download=${!0===n.download?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}createSignedUrls(e,t,n){return ae(this,void 0,void 0,(function*(){try{const r=yield oe(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),s=(null==n?void 0:n.download)?`&download=${!0===n.download?"":n.download}`:"";return{data:r.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${s}`):null}))),error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}download(e,t){return ae(this,void 0,void 0,(function*(){const n=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),s=r?`?${r}`:"";try{const t=this._getFinalPath(e),r=yield se(this.fetch,`${this.url}/${n}/${t}${s}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}info(e){return ae(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield se(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Z(e),error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}exists(e){return ae(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,n){return ee(this,void 0,void 0,(function*(){return re(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),undefined)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(V(e)&&e instanceof X){const t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}}))}getPublicUrl(e,t){const n=this._getFinalPath(e),r=[],s=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==s&&r.push(s);const o=void 0!==(null==t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==i&&r.push(i);let a=r.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${a}`)}}}remove(e){return ae(this,void 0,void 0,(function*(){try{return{data:yield ie(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}list(e,t,n){return ae(this,void 0,void 0,(function*(){try{const r=Object.assign(Object.assign(Object.assign({},ce),t),{prefix:e||""});return{data:yield oe(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const he={"X-Client-Info":"storage-js/2.7.1"};var ue=function(e,t,n,r){return new(n||(n=Promise))((function(s,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}))};class pe{constructor(e,t={},n){this.url=e,this.headers=Object.assign(Object.assign({},he),t),this.fetch=Q(n)}listBuckets(){return ue(this,void 0,void 0,(function*(){try{return{data:yield se(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}getBucket(e){return ue(this,void 0,void 0,(function*(){try{return{data:yield se(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}createBucket(e,t={public:!1}){return ue(this,void 0,void 0,(function*(){try{return{data:yield oe(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}updateBucket(e,t){return ue(this,void 0,void 0,(function*(){try{const n=yield function(e,t,n,r){return ee(this,void 0,void 0,(function*(){return re(e,"PUT",t,r,undefined,n)}))}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:n,error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}emptyBucket(e){return ue(this,void 0,void 0,(function*(){try{return{data:yield oe(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}deleteBucket(e){return ue(this,void 0,void 0,(function*(){try{return{data:yield ie(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(V(e))return{data:null,error:e};throw e}}))}}class me extends pe{constructor(e,t={},n){super(e,t,n)}from(e){return new de(this.url,this.headers,e,this.fetch)}}let ge="";ge="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const fe={headers:{"X-Client-Info":`supabase-js-${ge}/2.49.10`}},ve={schema:"public"},be={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ye={};var we=n(907);const xe=e=>{let t;return t=e||("undefined"==typeof fetch?we.default:fetch),(...e)=>t(...e)},_e=(e,t,n)=>{const r=xe(n),s="undefined"==typeof Headers?we.Headers:Headers;return(n,o)=>{return i=void 0,a=void 0,l=function*(){var i;const a=null!==(i=yield t())&&void 0!==i?i:e;let c=new s(null==o?void 0:o.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${a}`),r(n,Object.assign(Object.assign({},o),{headers:c}))},new((c=void 0)||(c=Promise))((function(e,t){function n(e){try{s(l.next(e))}catch(e){t(e)}}function r(e){try{s(l.throw(e))}catch(e){t(e)}}function s(t){var s;t.done?e(t.value):(s=t.value,s instanceof c?s:new c((function(e){e(s)}))).then(n,r)}s((l=l.apply(i,a||[])).next())}));var i,a,c,l}};const ke="2.69.1",Se=3e4,Ee={"X-Client-Info":`gotrue-js/${ke}`},Te="X-Supabase-Api-Version",Pe=Date.parse("2024-01-01T00:00:00.0Z"),Ae="2024-01-01",$e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Ce extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function Ie(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class Re extends Ce{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function je(e){return Ie(e)&&"AuthApiError"===e.name}class Oe extends Ce{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Le extends Ce{constructor(e,t,n,r){super(e,n,r),this.name=t,this.status=n}}class Ue extends Le{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ze(e){return Ie(e)&&"AuthSessionMissingError"===e.name}class De extends Le{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Me extends Le{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ne extends Le{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function qe(e){return Ie(e)&&"AuthImplicitGrantRedirectError"===e.name}class Fe extends Le{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ge extends Le{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function He(e){return Ie(e)&&"AuthRetryableFetchError"===e.name}class Be extends Le{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}function Je(e){return Ie(e)&&"AuthWeakPasswordError"===e.name}class Ye extends Le{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ke="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ve=" \t\n\r=".split(""),We=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Ve.length;t+=1)e[Ve[t].charCodeAt(0)]=-2;for(let t=0;t<Ke.length;t+=1)e[Ke[t].charCodeAt(0)]=t;return e})();function Xe(e,t,n){const r=We[e];if(!(r>-1)){if(-2===r)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function Qe(e){const t=[],n=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},o=e=>{!function(e,t,n){if(0===t.utf8seq){if(e<=127)return void n(e);for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&n(t.codepoint)}}(e,r,n)};for(let t=0;t<e.length;t+=1)Xe(e.charCodeAt(t),s,o);return t.join("")}function Ze(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function et(e){const t=[],n={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)Xe(e.charCodeAt(t),n,r);return new Uint8Array(t)}const tt=()=>"undefined"!=typeof window&&"undefined"!=typeof document,nt={tested:!1,writable:!1},rt=()=>{if(!tt())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(nt.tested)return nt.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),nt.tested=!0,nt.writable=!0}catch(e){nt.tested=!0,nt.writable=!1}return nt.writable},st=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(n.bind(n,907)).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},ot=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},it=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch(e){return n}},at=async(e,t)=>{await e.removeItem(t)};class ct{constructor(){this.promise=new ct.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function lt(e){const t=e.split(".");if(3!==t.length)throw new Ye("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!$e.test(t[e]))throw new Ye("JWT not in base64url format");return{header:JSON.parse(Qe(t[0])),payload:JSON.parse(Qe(t[1])),signature:et(t[2]),raw:{header:t[0],payload:t[1]}}}function dt(e){return("0"+e.toString(16)).substr(-2)}async function ht(e,t,n=!1){const r=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let n="";for(let r=0;r<56;r++)n+=e.charAt(Math.floor(Math.random()*t));return n}return crypto.getRandomValues(e),Array.from(e,dt).join("")}();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await ot(e,`${t}-code-verifier`,s);const o=await async function(e){if("undefined"==typeof crypto||void 0===crypto.subtle||"undefined"==typeof TextEncoder)return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(n);return Array.from(r).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}(r);return[o,r===o?"plain":"s256"]}ct.promiseConstructor=Promise;const ut=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const pt=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),mt=[502,503,504];async function gt(e){var t,n;if(!("object"==typeof(n=e)&&null!==n&&"status"in n&&"ok"in n&&"json"in n&&"function"==typeof n.json))throw new Ge(pt(e),0);if(mt.includes(e.status))throw new Ge(pt(e),e.status);let r,s;try{r=await e.json()}catch(e){throw new Oe(pt(e),e)}const o=function(e){const t=e.headers.get(Te);if(!t)return null;if(!t.match(ut))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(o&&o.getTime()>=Pe&&"object"==typeof r&&r&&"string"==typeof r.code?s=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(s=r.error_code),s){if("weak_password"===s)throw new Be(pt(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===s)throw new Ue}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0))throw new Be(pt(r),e.status,r.weak_password.reasons);throw new Re(pt(r),e.status||500,s)}async function ft(e,t,n,r){var s;const o=Object.assign({},null==r?void 0:r.headers);o[Te]||(o[Te]=Ae),(null==r?void 0:r.jwt)&&(o.Authorization=`Bearer ${r.jwt}`);const i=null!==(s=null==r?void 0:r.query)&&void 0!==s?s:{};(null==r?void 0:r.redirectTo)&&(i.redirect_to=r.redirectTo);const a=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await async function(e,t,n,r,s,o){const i=((e,t,n,r)=>{const s={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))})(t,r,{},o);let a;try{a=await e(n,Object.assign({},i))}catch(e){throw console.error(e),new Ge(pt(e),0)}if(a.ok||await gt(a),null==r?void 0:r.noResolveJson)return a;try{return await a.json()}catch(e){await gt(e)}}(e,t,n+a,{headers:o,noResolveJson:null==r?void 0:r.noResolveJson},0,null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(c):{data:Object.assign({},c),error:null}}function vt(e){var t;let n=null;var r;return function(e){return e.access_token&&e.refresh_token&&e.expires_in}(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r))),{data:{session:n,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function bt(e){const t=vt(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function yt(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function wt(e){return{data:e,error:null}}function xt(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:o}=e,i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n}(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:o},user:Object.assign({},i)},error:null}}function _t(e){return e}class kt{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=st(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await ft(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(Ie(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await ft(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:yt})}catch(e){if(Ie(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{const{options:t}=e,n=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n}(e,["options"]),r=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(r.new_email=null==n?void 0:n.newEmail,delete r.newEmail),await ft(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:xt,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(Ie(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await ft(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:yt})}catch(e){if(Ie(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,n,r,s,o,i,a;try{const c={nextPage:null,lastPage:0,total:0},l=await ft(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(s=null===(r=null==e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==s?s:""},xform:_t});if(l.error)throw l.error;const d=await l.json(),h=null!==(o=l.headers.get("x-total-count"))&&void 0!==o?o:0,u=null!==(a=null===(i=l.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==a?a:[];return u.length>0&&(u.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);c[`${n}Page`]=t})),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(e){if(Ie(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){try{return await ft(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:yt})}catch(e){if(Ie(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){try{return await ft(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:yt})}catch(e){if(Ie(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){try{return await ft(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:yt})}catch(e){if(Ie(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){try{const{data:t,error:n}=await ft(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:n}}catch(e){if(Ie(e))return{data:null,error:e};throw e}}async _deleteFactor(e){try{return{data:await ft(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(Ie(e))return{data:null,error:e};throw e}}}const St={getItem:e=>rt()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{rt()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{rt()&&globalThis.localStorage.removeItem(e)}};function Et(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}const Tt={debug:!!(globalThis&&rt()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class Pt extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class At extends Pt{}async function $t(e,t,n){Tt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout((()=>{r.abort(),Tt.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},(async r=>{if(!r){if(0===t)throw Tt.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new At(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Tt.debug)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}Tt.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await n()}finally{Tt.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}))))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const Ct={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ee,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function It(e,t,n){return await n()}class Rt{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Rt.nextInstanceID,Rt.nextInstanceID+=1,this.instanceID>0&&tt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Ct),e);if(this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new kt({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=st(r.fetch),this.lock=r.lock||It,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:tt()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=$t:this.lock=It,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:rt()?this.storage=St:(this.memoryStorage={},this.storage=Et(this.memoryStorage)):(this.memoryStorage={},this.storage=Et(this.memoryStorage)),tt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(n=this.broadcastChannel)||void 0===n||n.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ke}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},n=new URL(e);if(n.hash&&"#"===n.hash[0])try{new URLSearchParams(n.hash.substring(1)).forEach(((e,n)=>{t[n]=e}))}catch(e){}return n.searchParams.forEach(((e,n)=>{t[n]=e})),t}(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),tt()&&this.detectSessionInUrl&&"none"!==n){const{data:r,error:s}=await this._getSessionFromURL(t,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),qe(s)){const t=null===(e=s.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:s}}return await this._removeSession(),{error:s}}const{session:o,redirectType:i}=r;return this._debug("#_initialize()","detected session in URL",o,"redirect type",i),await this._saveSession(o),setTimeout((async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return Ie(e)?{error:e}:{error:new Oe("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,r;try{const s=await ft(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(n=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==n?n:{},gotrue_meta_security:{captcha_token:null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:vt}),{data:o,error:i}=s;if(i||!o)return{data:{user:null,session:null},error:i};const a=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(e){if(Ie(e))return{data:{user:null,session:null},error:e};throw e}}async signUp(e){var t,n,r;try{let s;if("email"in e){const{email:n,password:r,options:o}=e;let i=null,a=null;"pkce"===this.flowType&&([i,a]=await ht(this.storage,this.storageKey)),s=await ft(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==o?void 0:o.emailRedirectTo,body:{email:n,password:r,data:null!==(t=null==o?void 0:o.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken},code_challenge:i,code_challenge_method:a},xform:vt})}else{if(!("phone"in e))throw new Me("You must provide either an email or phone number and a password");{const{phone:t,password:o,options:i}=e;s=await ft(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:o,data:null!==(n=null==i?void 0:i.data)&&void 0!==n?n:{},channel:null!==(r=null==i?void 0:i.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:vt})}}const{data:o,error:i}=s;if(i||!o)return{data:{user:null,session:null},error:i};const a=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(e){if(Ie(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if("email"in e){const{email:n,password:r,options:s}=e;t=await ft(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:n,password:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:bt})}else{if(!("phone"in e))throw new Me("You must provide either an email or phone number and a password");{const{phone:n,password:r,options:s}=e;t=await ft(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:n,password:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},xform:bt})}}const{data:n,error:r}=t;return r?{data:{user:null,session:null},error:r}:n&&n.session&&n.user?(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:r}):{data:{user:null,session:null},error:new De}}catch(e){if(Ie(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,n,r,s;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(s=e.options)||void 0===s?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await it(this.storage,`${this.storageKey}-code-verifier`),[n,r]=(null!=t?t:"").split("/");try{const{data:t,error:s}=await ft(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:vt});if(await at(this.storage,`${this.storageKey}-code-verifier`),s)throw s;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=r?r:null}),error:s}):{data:{user:null,session:null,redirectType:null},error:new De}}catch(e){if(Ie(e))return{data:{user:null,session:null,redirectType:null},error:e};throw e}}async signInWithIdToken(e){try{const{options:t,provider:n,token:r,access_token:s,nonce:o}=e,i=await ft(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:r,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:vt}),{data:a,error:c}=i;return c?{data:{user:null,session:null},error:c}:a&&a.session&&a.user?(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:c}):{data:{user:null,session:null},error:new De}}catch(e){if(Ie(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,n,r,s,o;try{if("email"in e){const{email:r,options:s}=e;let o=null,i=null;"pkce"===this.flowType&&([o,i]=await ht(this.storage,this.storageKey));const{error:a}=await ft(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null==s?void 0:s.data)&&void 0!==t?t:{},create_user:null===(n=null==s?void 0:s.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},code_challenge:o,code_challenge_method:i},redirectTo:null==s?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){const{phone:t,options:n}=e,{data:i,error:a}=await ft(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null==n?void 0:n.data)&&void 0!==r?r:{},create_user:null===(s=null==n?void 0:n.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},channel:null!==(o=null==n?void 0:n.channel)&&void 0!==o?o:"sms"}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:a}}throw new Me("You must provide either an email or phone number.")}catch(e){if(Ie(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,n;try{let r,s;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,s=null===(n=e.options)||void 0===n?void 0:n.captchaToken);const{data:o,error:i}=await ft(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:r,xform:vt});if(i)throw i;if(!o)throw new Error("An error occurred on token verification.");const a=o.session,c=o.user;return(null==a?void 0:a.access_token)&&(await this._saveSession(a),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:c,session:a},error:null}}catch(e){if(Ie(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,n,r;try{let s=null,o=null;return"pkce"===this.flowType&&([s,o]=await ht(this.storage,this.storageKey)),await ft(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==n?n:void 0}),(null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:wt})}catch(e){if(Ie(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Ue;const{error:r}=await ft(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}}))}catch(e){if(Ie(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:r,options:s}=e,{error:o}=await ft(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}},redirectTo:null==s?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:n,type:r,options:s}=e,{data:o,error:i}=await ft(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:r,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:null==o?void 0:o.message_id},error:i}}throw new Me("You must provide either an email or phone number and a type")}catch(e){if(Ie(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch(e){}})()),n}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await it(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=!!e.expires_at&&1e3*e.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,n,r)=>(t||"user"!==n||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,n,r))})}return{data:{session:e},error:null}}const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,(async()=>await this._getUser())))}async _getUser(e){try{return e?await ft(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:yt}):await this._useSession((async e=>{var t,n,r;const{data:s,error:o}=e;if(o)throw o;return(null===(t=s.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await ft(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(n=s.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0,xform:yt}):{data:{user:null},error:new Ue}}))}catch(e){if(Ie(e))return ze(e)&&(await this._removeSession(),await at(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e,t={}){try{return await this._useSession((async n=>{const{data:r,error:s}=n;if(s)throw s;if(!r.session)throw new Ue;const o=r.session;let i=null,a=null;"pkce"===this.flowType&&null!=e.email&&([i,a]=await ht(this.storage,this.storageKey));const{data:c,error:l}=await ft(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:a}),jwt:o.access_token,xform:yt});if(l)throw l;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}}))}catch(e){if(Ie(e))return{data:{user:null},error:e};throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ue;const t=Date.now()/1e3;let n=t,r=!0,s=null;const{payload:o}=lt(e.access_token);if(o.exp&&(n=o.exp,r=n<=t),r){const{session:t,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return{data:{user:null,session:null},error:n};if(!t)return{data:{user:null,session:null},error:null};s=t}else{const{data:r,error:o}=await this._getUser(e.access_token);if(o)throw o;s={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(e){if(Ie(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var n;if(!e){const{data:r,error:s}=t;if(s)throw s;e=null!==(n=r.session)&&void 0!==n?n:void 0}if(!(null==e?void 0:e.refresh_token))throw new Ue;const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}))}catch(e){if(Ie(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e,t){try{if(!tt())throw new Ne("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ne(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Fe("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new Ne("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Fe("No code detected.");const{data:t,error:n}=await this._exchangeCodeForSession(e.code);if(n)throw n;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:r,access_token:s,refresh_token:o,expires_in:i,expires_at:a,token_type:c}=e;if(!(s&&i&&o&&c))throw new Ne("No session defined in URL");const l=Math.round(Date.now()/1e3),d=parseInt(i);let h=l+d;a&&(h=parseInt(a));const u=h-l;1e3*u<=Se&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${u}s, should have been closer to ${d}s`);const p=h-d;l-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,l):l-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,l);const{data:m,error:g}=await this._getUser(s);if(g)throw g;const f={provider_token:n,provider_refresh_token:r,access_token:s,expires_in:d,expires_at:h,refresh_token:o,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:f,redirectType:e.type},error:null}}catch(e){if(Ie(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await it(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut({scope:e}={scope:"global"}){return await this._useSession((async t=>{var n;const{data:r,error:s}=t;if(s)return{error:s};const o=null===(n=r.session)||void 0===n?void 0:n.access_token;if(o){const{error:t}=await this.admin.signOut(o,e);if(t&&(!je(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await at(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession((async t=>{var n,r;try{const{data:{session:r},error:s}=t;if(s)throw s;await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(t){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}}))}async resetPasswordForEmail(e,t={}){let n=null,r=null;"pkce"===this.flowType&&([n,r]=await ht(this.storage,this.storageKey,!0));try{return await ft(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(Ie(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(e){if(Ie(e))return{data:null,error:e};throw e}}async linkIdentity(e){var t;try{const{data:n,error:r}=await this._useSession((async t=>{var n,r,s,o,i;const{data:a,error:c}=t;if(c)throw c;const l=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(n=e.options)||void 0===n?void 0:n.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:!0});return await ft(this.fetch,"GET",l,{headers:this.headers,jwt:null!==(i=null===(o=a.session)||void 0===o?void 0:o.access_token)&&void 0!==i?i:void 0})}));if(r)throw r;return tt()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==n?void 0:n.url),{data:{provider:e.provider,url:null==n?void 0:n.url},error:null}}catch(t){if(Ie(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var n,r;const{data:s,error:o}=t;if(o)throw o;return await ft(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(n=s.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0})}))}catch(e){if(Ie(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await(n=async n=>(n>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await ft(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:vt})),r=(e,t)=>{const n=200*Math.pow(2,e);return t&&He(t)&&Date.now()+n-s<Se},new Promise(((e,t)=>{(async()=>{for(let s=0;s<1/0;s++)try{const t=await n(s);if(!r(s,null))return void e(t)}catch(e){if(!r(s,e))return void t(e)}})()})))}catch(e){if(this._debug(t,"error",e),Ie(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}var n,r}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),tt()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await it(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n))return this._debug(t,"session is not valid"),void(null!==n&&await this._removeSession());const r=1e3*(null!==(e=n.expires_at)&&void 0!==e?e:1/0)-Date.now()<9e4;if(this._debug(t,`session has${r?"":" not"} expired with margin of 90000s`),r){if(this.autoRefreshToken&&n.refresh_token){const{error:e}=await this._callRefreshToken(n.refresh_token);e&&(console.error(e),He(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(e){return this._debug(t,"error",e),void console.error(e)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Ue;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new ct;const{data:t,error:n}=await this._refreshAccessToken(e);if(n)throw n;if(!t.session)throw new Ue;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(e){if(this._debug(r,"error",e),Ie(e)){const n={session:null,error:e};return He(e)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(n),n}throw null===(n=this.refreshingDeferred)||void 0===n||n.reject(e),e}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,n=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],s=Array.from(this.stateChangeEmitters.values()).map((async n=>{try{await n.callback(e,t)}catch(e){r.push(e)}}));if(await Promise.all(s),r.length>0){for(let e=0;e<r.length;e+=1)console.error(r[e]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await ot(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await at(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&tt()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),Se);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const e=Date.now();try{return await this._useSession((async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*n.expires_at-e)/Se);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(n.refresh_token)}))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof Pt))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!tt()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const r=[`provider=${encodeURIComponent(t)}`];if((null==n?void 0:n.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),(null==n?void 0:n.scopes)&&r.push(`scopes=${encodeURIComponent(n.scopes)}`),"pkce"===this.flowType){const[e,t]=await ht(this.storage,this.storageKey),n=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(n.toString())}if(null==n?void 0:n.queryParams){const e=new URLSearchParams(n.queryParams);r.push(e.toString())}return(null==n?void 0:n.skipBrowserRedirect)&&r.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var n;const{data:r,error:s}=t;return s?{data:null,error:s}:await ft(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(n=null==r?void 0:r.session)||void 0===n?void 0:n.access_token})}))}catch(e){if(Ie(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession((async t=>{var n,r;const{data:s,error:o}=t;if(o)return{data:null,error:o};const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:a,error:c}=await ft(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:null===(n=null==s?void 0:s.session)||void 0===n?void 0:n.access_token});return c?{data:null,error:c}:("totp"===e.factorType&&(null===(r=null==a?void 0:a.totp)||void 0===r?void 0:r.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})}))}catch(e){if(Ie(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var n;const{data:r,error:s}=t;if(s)return{data:null,error:s};const{data:o,error:i}=await ft(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(n=null==r?void 0:r.session)||void 0===n?void 0:n.access_token});return i?{data:null,error:i}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:i})}))}catch(e){if(Ie(e))return{data:null,error:e};throw e}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var n;const{data:r,error:s}=t;return s?{data:null,error:s}:await ft(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(n=null==r?void 0:r.session)||void 0===n?void 0:n.access_token})}))}catch(e){if(Ie(e))return{data:null,error:e};throw e}}))}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(null==e?void 0:e.factors)||[],r=n.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),s=n.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:n,totp:r,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,n;const{data:{session:r},error:s}=e;if(s)return{data:null,error:s};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=lt(r.access_token);let i=null;o.aal&&(i=o.aal);let a=i;return(null!==(n=null===(t=r.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==n?n:[]).length>0&&(a="aal2"),{data:{currentLevel:i,nextLevel:a,currentAuthenticationMethods:o.amr||[]},error:null}}))))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find((t=>t.kid===e));if(n)return n;if(n=this.jwks.keys.find((t=>t.kid===e)),n&&this.jwks_cached_at+6e5>Date.now())return n;const{data:r,error:s}=await ft(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!r.keys||0===r.keys.length)throw new Ye("JWKS is empty");if(this.jwks=r,this.jwks_cached_at=Date.now(),n=r.keys.find((t=>t.kid===e)),!n)throw new Ye("No matching signing key found in JWKS");return n}async getClaims(e,t={keys:[]}){try{let n=e;if(!n){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};n=e.session.access_token}const{header:r,payload:s,signature:o,raw:{header:i,payload:a}}=lt(n);if(function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(s.exp),!r.kid||"HS256"===r.alg||!("crypto"in globalThis)||!("subtle"in globalThis.crypto)){const{error:e}=await this.getUser(n);if(e)throw e;return{data:{claims:s,header:r,signature:o},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(r.alg),l=await this.fetchJwk(r.kid,t),d=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,o,function(e){const t=[];return function(e,t){for(let n=0;n<e.length;n+=1){let r=e.charCodeAt(n);if(r>55295&&r<=56319){const t=1024*(r-55296)&65535;r=65536+(e.charCodeAt(n+1)-56320&65535|t),n+=1}Ze(r,t)}}(e,(e=>t.push(e))),new Uint8Array(t)}(`${i}.${a}`)))throw new Ye("Invalid JWT signature");return{data:{claims:s,header:r,signature:o},error:null}}catch(e){if(Ie(e))return{data:null,error:e};throw e}}}Rt.nextInstanceID=0;const jt=kt,Ot=Rt;class Lt extends Ot{constructor(e){super(e)}}class Ut{constructor(e,t,n){var r,s,o;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const i=(a=e).endsWith("/")?a:a+"/";var a;const c=new URL(i);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const l=`sb-${c.hostname.split(".")[0]}-auth-token`,h=function(e,t){var n,r;const{db:s,auth:o,realtime:i,global:a}=e,{db:c,auth:l,realtime:d,global:h}=t,u={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},l),o),realtime:Object.assign(Object.assign({},d),i),global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},null!==(n=null==h?void 0:h.headers)&&void 0!==n?n:{}),null!==(r=null==a?void 0:a.headers)&&void 0!==r?r:{})}),accessToken:()=>{return e=this,t=void 0,r=function*(){return""},new((n=void 0)||(n=Promise))((function(s,o){function i(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,a)}c((r=r.apply(e,t||[])).next())}));var e,t,n,r}};return e.accessToken?u.accessToken=e.accessToken:delete u.accessToken,u}(null!=n?n:{},{db:ve,realtime:ye,auth:Object.assign(Object.assign({},be),{storageKey:l}),global:fe});this.storageKey=null!==(r=h.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(s=h.global.headers)&&void 0!==s?s:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(o=h.auth)&&void 0!==o?o:{},this.headers,h.global.fetch),this.fetch=_e(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new d(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new c(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new me(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t,n,r,s,o;return n=this,r=void 0,o=function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return null!==(t=null===(e=n.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null},new((s=void 0)||(s=Promise))((function(e,t){function i(e){try{c(o.next(e))}catch(e){t(e)}}function a(e){try{c(o.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof s?n:new s((function(e){e(n)}))).then(i,a)}c((o=o.apply(n,r||[])).next())}))}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:r,storageKey:s,flowType:o,lock:i,debug:a},c,l){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Lt({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),c),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:r,flowType:o,lock:i,debug:a,fetch:l,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new J(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)}))}_handleTokenChanged(e,t,n){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===n?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=n}}const zt=(e,t,n)=>new Ut(e,t,n)},7868:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=':host {\n  display: block;\n  font-family: "Inter", sans-serif;\n  color: var(--color-input-text);\n}\n\n.post-card {\n  background-color: var(--color-panel);\n  border-radius: 8px;\n  padding: 1.5rem;\n  margin-bottom: 1.5rem;\n  box-shadow: 0 4px 12px rgba(11, 14, 23, 0.75); /* dark blue tint shadow */\n  transition: transform 0.3s ease, box-shadow 0.3s ease;\n  cursor: pointer;\n}\n\n.post-card:hover {\n  transform: translateY(-3px);\n  box-shadow: 0 6px 16px rgba(11, 14, 23, 0.9);\n}\n\n.post-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 1rem;\n}\n\n.profile-picture {\n  width: 48px;\n  height: 48px;\n  border-radius: 50%;\n  object-fit: cover;\n  margin-right: 1rem;\n  border: 2px solid var(--color-rose);\n  transition: transform 0.3s ease;\n}\n\n.profile-picture:hover {\n  transform: scale(1.1);\n}\n\n.post-info {\n  display: flex;\n  flex-direction: column;\n}\n\n.username {\n  margin: 0;\n  font-size: 1rem;\n  font-weight: 600;\n  color: var(--color-input-text);\n}\n\n.timestamp {\n  font-size: 0.8rem;\n  color: var(--color-muted);\n}\n\n.post-content {\n  margin-bottom: 1rem;\n}\n\n.content-text {\n  margin: 0 0 1rem;\n  font-size: 1rem;\n  line-height: 1.5;\n  color: var(--color-input-text);\n}\n\n.content-image {\n  width: 100%;\n  border-radius: 8px;\n  max-height: 400px;\n  object-fit: cover;\n  transition: transform 0.3s ease;\n}\n\n.content-image:hover {\n  transform: scale(1.02);\n}\n\n.post-actions {\n  display: flex;\n  justify-content: space-between;\n  padding-top: 0.75rem;\n  border-top: 1px solid var(--color-border);\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n  color: var(--color-muted);\n  transition: color 0.3s ease, transform 0.2s ease;\n  cursor: pointer;\n  padding: 0.5rem;\n  border-radius: 4px;\n  background: transparent;\n}\n\n.action-btn:hover {\n  color: var(--color-rose);\n  transform: translateY(-2px);\n  background-color: rgba(191, 52, 103, 0.1); /* --color-rose with 10% opacity */\n}\n\n.action-btn svg {\n  fill: none;\n  stroke: currentColor;\n  stroke-width: 2;\n  stroke-linecap: round;\n  stroke-linejoin: round;\n  transition: fill 0.3s ease, stroke 0.3s ease;\n}\n\n.action-btn.active {\n  color: var(--color-rose);\n}\n\n.action-btn.active svg {\n  fill: currentColor;\n}\n\n.like-btn.active {\n  color: var(--color-rose);\n}\n\n.like-btn.active svg {\n  fill: var(--color-rose);\n  stroke: var(--color-rose);\n}\n\n.save-btn.active {\n  color: gold;\n}\n\n.save-btn.active svg {\n  fill: gold;\n  stroke: gold;\n}\n\n.game-tag {\n  background-color: var(--color-input-background);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0.2rem 0.5rem;\n  border-radius: 4px;\n  gap: 4px;\n  margin: 4px;\n  margin-bottom: 8px;\n  width: fit-content;\n}\n\n/* Add animation for like action */\n@keyframes likeAnimation {\n  0% {\n    transform: scale(1);\n  }\n  50% {\n    transform: scale(1.2);\n  }\n  100% {\n    transform: scale(1);\n  }\n}\n\n.like-btn.animating svg {\n  animation: likeAnimation 0.3s ease;\n}\n\n@media (max-width: 768px) {\n  .post-card {\n    padding: 1rem;\n  }\n\n  .profile-picture {\n    width: 40px;\n    height: 40px;\n  }\n\n  .username {\n    font-size: 0.9rem;\n  }\n\n  .content-text {\n    font-size: 0.95rem;\n  }\n\n  .action-btn {\n    padding: 0.3rem;\n  }\n\n  .action-btn span {\n    font-size: 0.9rem;\n  }\n}\n\n@media (max-width: 480px) {\n  .post-actions {\n    justify-content: space-around;\n  }\n\n  .action-btn {\n    flex-direction: column;\n    gap: 0.2rem;\n  }\n\n  .action-btn span {\n    font-size: 0.8rem;\n  }\n}\n'},7933:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=":host {\n  display: block;\n}\n\n.register-container {\n  background-color: var(--color-panel);\n  border-radius: 10px;\n  padding: 2rem;\n  width: 100%;\n  animation: fadeIn 0.6s ease;\n  max-width: 400px;\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\nh2 {\n  color: var(--color-input-text);\n  text-align: center;\n  margin: 0 0 2rem;\n  font-size: 1.8rem;\n  font-weight: 700;\n}\n\n.form-group {\n  margin-bottom: 1.5rem;\n}\n\nlabel {\n  display: block;\n  margin-bottom: 0.5rem;\n  color: var(--color-muted);\n  font-size: 0.9rem;\n  font-weight: 500;\n}\n\ninput {\n  width: 95%;\n  padding: 0.8rem 1rem;\n  border: 2px solid var(--color-border);\n  background-color: var(--color-input-background);\n  color: var(--color-input-text);\n  border-radius: 6px;\n  font-size: 1rem;\n  transition: border-color 0.3s ease, box-shadow 0.3s ease;\n}\n\ninput:focus {\n  outline: none;\n  border-color: var(--color-rose);\n  box-shadow: 0 0 0 3px rgba(191, 52, 103, 0.2);\n}\n\nbutton {\n  width: 100%;\n  padding: 1rem;\n  background-color: var(--color-rose);\n  color: var(--color-primary-text);\n  border: none;\n  border-radius: 6px;\n  font-size: 1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: background-color 0.3s ease, transform 0.2s ease;\n  margin-top: 1.5rem;\n}\n\nbutton:hover {\n  background-color: #a02b57;\n  transform: translateY(-2px);\n}\n\nbutton:active {\n  transform: translateY(0);\n}\n\n.login-text {\n  text-align: center;\n  margin-top: 1.5rem;\n  color: var(--color-muted);\n  font-size: 0.9rem;\n}\n\na {\n  color: var(--color-rose);\n  text-decoration: none;\n  font-weight: 600;\n  transition: color 0.3s ease;\n}\n\na:hover {\n  color: #a02b57;\n  text-decoration: underline;\n}\n\n@media (max-width: 480px) {\n  .login-container {\n    padding: 1.5rem;\n  }\n\n  h2 {\n    font-size: 1.5rem;\n    margin-bottom: 1.5rem;\n  }\n\n  input {\n    padding: 0.7rem 0.9rem;\n    font-size: 0.95rem;\n  }\n\n  .login-button {\n    padding: 0.8rem;\n  }\n}\n"},8156:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(8683)),o=r(n(4613)),i=r(n(9536)),a=r(n(9890)),c=n(9800),l=r(n(1187)),d=r(n(2555)),h=r(n(2553)),u=r(n(4157)),p=r(n(8449)),m=r(n(7180)),g=r(n(6765)),f=r(n(9013)),v=r(n(116)),b=r(n(4590)),y=r(n(3746));console.log("App started"),customElements.get("app-container")||customElements.define("app-container",c.AppContainer),customElements.get("app-header")||customElements.define("app-header",a.default),customElements.get("auth-screen")||customElements.define("auth-screen",l.default),customElements.get("landing-screen")||customElements.define("landing-screen",u.default),customElements.get("threads-screen")||customElements.define("threads-screen",g.default),customElements.get("thread-detail-screen")||customElements.define("thread-detail-screen",m.default),customElements.get("categories-screen")||customElements.define("categories-screen",d.default),customElements.get("community-screen")||customElements.define("community-screen",h.default),customElements.get("profile-screen")||customElements.define("profile-screen",p.default),customElements.get("edit-profile-modal")||customElements.define("edit-profile-modal",f.default),customElements.get("create-post")||customElements.define("create-post",v.default),customElements.get("post-card")||customElements.define("post-card",b.default),customElements.get("game-card")||customElements.define("game-card",y.default),customElements.get("login-form")||customElements.define("login-form",s.default),customElements.get("register-form")||customElements.define("register-form",o.default),customElements.get("comment-card")||customElements.define("comment-card",i.default)},8261:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(4279));class o extends s.default{select(e){let t=!1;const n=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:n,foreignTable:r,referencedTable:s=r}={}){const o=s?`${s}.order`:"order",i=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${i?`${i},`:""}${e}.${t?"asc":"desc"}${void 0===n?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:n=t}={}){const r=void 0===n?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:n,referencedTable:r=n}={}){const s=void 0===r?"offset":`${r}.offset`,o=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(o,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:r=!1,wal:s=!1,format:o="text"}={}){var i;const a=[e?"analyze":null,t?"verbose":null,n?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=null!==(i=this.headers.Accept)&&void 0!==i?i:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${c}"; options=${a};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=o},8449:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(7047),o=n(6646),i=n(9006);n(4590),n(3746),n(9013);const a=r(n(3061));class c extends HTMLElement{showEditModal=!1;constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render();const e=this.shadowRoot?.querySelector("#saved-tab"),t=this.shadowRoot?.querySelector("#games-tab"),n=this.shadowRoot?.querySelector("#stats-tab"),r=this.shadowRoot?.querySelector(".edit-profile-btn"),s=this.shadowRoot?.querySelectorAll(".tab-content");e?.addEventListener("click",(()=>{this.activateTab(e,s,"saved-content")})),t?.addEventListener("click",(()=>{this.activateTab(t,s,"games-content")})),n?.addEventListener("click",(()=>{this.activateTab(n,s,"stats-content")})),r?.addEventListener("click",(()=>{this.showEditModal=!0,this.render()}))}activateTab(e,t,n){const r=this.shadowRoot?.querySelectorAll(".tab-item");r?.forEach((e=>e.classList.remove("active"))),e.classList.add("active"),t?.forEach((e=>{e.classList.remove("active"),e.id===n&&e.classList.add("active")}))}handleEditModalClose=()=>{this.showEditModal=!1,this.render()};renderSavedPosts(){const e=s.appState.get();if(!e.isAuthenticated)return'<p class="empty-message">Log in to save posts</p>';const t=e.posts.filter((e=>e.isSaved));return 0===t.length?'<p class="empty-message">No saved posts yet</p>':t.map((e=>`\n      <post-card\n        postid="${e.id}"\n        userid="${e.userId}"\n        username="${e.username}"\n        pfp="${e.profilePicture}"\n        content="${e.content}"\n        ${e.imageUrl?`imageurl="${e.imageUrl}"`:""}\n        likes="${e.likes}"\n        reposts="${e.reposts}"\n        comments="${e.comments}"\n        saves="${e.saves}"\n        timestamp="${e.timestamp}"\n        ${e.gameId?`gameid="${e.gameId}"`:""}\n        isliked="${e.isLiked||!1}"\n        issaved="${e.isSaved||!0}">\n      </post-card>\n    `)).join("")}renderGames(){const e=s.appState.get();if(!e.isAuthenticated||!e.currentUser)return'<p class="empty-message">Log in to see your games</p>';const t=e.posts.filter((t=>t.userId===e.currentUser?.id&&t.gameId)),n={};t.forEach((e=>{e.gameId&&(n[e.gameId]=(n[e.gameId]||0)+1)}));const r=Object.entries(n).sort(((e,t)=>t[1]-e[1])).map((([e])=>e)).map((t=>e.games.find((e=>e.id===t)))).filter(Boolean).slice(0,4);return 0===r.length?'<p class="empty-message">No favorite games yet</p>':`\n      <div class="games-grid">\n        ${r.map((e=>`\n          <game-card\n            gameId="${e?.id}"\n            title="${e?.title}"\n            category="${e?.category}"\n            imageUrl="${e?.imageUrl}"\n            rating="${e?.rating}">\n          </game-card>\n        `)).join("")}\n      </div>\n    `}renderPosts(){const e=s.appState.get();if(!e.isAuthenticated)return'<p class="empty-message">Log in to save posts</p>';const t=e.posts.filter((t=>t.userId===e.currentUser?.id));return 0===t.length?'<p class="empty-message">Nothing from your part yet</p>':t.map((e=>`\n      <post-card\n        postid="${e.id}"\n        userid="${e.userId}"\n        username="${e.username}"\n        pfp="${e.profilePicture}"\n        content="${e.content}"\n        ${e.imageUrl?`imageurl="${e.imageUrl}"`:""}\n        likes="${e.likes}"\n        reposts="${e.reposts}"\n        comments="${e.comments}"\n        saves="${e.saves}"\n        timestamp="${e.timestamp}"\n        ${e.gameId?`gameid="${e.gameId}"`:""}\n        isliked="${e.isLiked||!1}"\n        issaved="${e.isSaved||!1}">\n      </post-card>\n    `)).join("")}render(){const e=s.appState.get(),t=e.currentUser;if(console.log(JSON.stringify(e.currentUser?.profilePicture)),this.shadowRoot){this.shadowRoot.innerHTML=`\n        <style>${a.default}</style>\n        <div class="profile-container">\n          ${e.isAuthenticated?`\n              <div class="profile-header">\n                <div class="profile-cover"></div>\n                <div class="profile-info">\n                  <img src="${t?.profilePicture}" alt="${t?.username}" class="profile-picture">\n                  <h2 class="username">${t?.username}</h2>\n                  <p class="bio">${t?.bio}</p>\n                  <div class="stats">\n                    <div class="stat">\n                      <span class="value">${t?.followers}</span>\n                      <span class="label">Followers</span>\n                    </div>\n                    <div class="stat">\n                      <span class="value">${t?.following}</span>\n                      <span class="label">Following</span>\n                    </div>\n                  </div>\n                  <button class="edit-profile-btn">Edit Profile</button>\n                </div>\n              </div>\n\n              <div class="profile-content">\n                <div class="tabs">\n                  <div id="saved-tab" class="tab-item active">Posts</div>\n                  <div id="games-tab" class="tab-item">Games</div>\n                  <div id="stats-tab" class="tab-item">Saved</div>\n                </div>\n\n                <div class="tab-contents">\n                  <div id="saved-content" class="tab-content active">\n                    ${this.renderPosts()}\n                  </div>\n                  <div id="games-content" class="tab-content">\n                    ${this.renderGames()}\n                  </div>\n                  <div id="stats-content" class="tab-content">\n                    ${this.renderSavedPosts()}\n                  </div>\n                </div>\n              </div>\n\n              ${this.showEditModal?"\n                <edit-profile-modal></edit-profile-modal>\n              ":""}\n            `:'\n              <div class="login-required">\n                <h2>Login Required</h2>\n                <p>Please log in to view your profile</p>\n                <button id="login-btn" class="login-btn">Go to Login</button>\n              </div>\n            '}\n        </div>\n      `;const n=this.shadowRoot.querySelector("#login-btn"),r=this.shadowRoot.querySelector("edit-profile-modal");n?.addEventListener("click",(()=>{(0,o.navigate)(i.Screens.LOGIN)})),r?.addEventListener("close",this.handleEditModalClose)}}disconnectedCallback(){const e=this.shadowRoot?.querySelector("edit-profile-modal");e?.removeEventListener("close",this.handleEditModalClose)}}t.default=c},8683:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(6646),o=n(3015),i=r(n(839));class a extends HTMLElement{boundHandleSubmit;boundHandleRegisterClick;constructor(){super(),this.attachShadow({mode:"open"}),this.boundHandleSubmit=this.handleSubmit.bind(this),this.boundHandleRegisterClick=this.handleRegisterClick.bind(this)}connectedCallback(){this.render();const e=this.shadowRoot?.querySelector("form"),t=this.shadowRoot?.querySelector("#register-link");e?.addEventListener("submit",this.boundHandleSubmit),t?.addEventListener("click",this.boundHandleRegisterClick)}disconnectedCallback(){const e=this.shadowRoot?.querySelector("form"),t=this.shadowRoot?.querySelector("#register-link");e?.removeEventListener("submit",this.boundHandleSubmit),t?.removeEventListener("click",this.boundHandleRegisterClick)}async handleSubmit(e){e.preventDefault();const t=new FormData(e.target),n=t.get("username"),r=t.get("password");if(n&&r)try{const{user:e,userProfile:t,session:i,error:a}=await(0,o.loginWithSupa)(n,r);if(a)return console.error("Login error:",a),void alert("Login failed. Please check your credentials.");if(console.log("Login successful:",e),e&&i){const n={id:e.id,username:t.username||"Unknown",profilePicture:t.profilePicture||"https://i.pinimg.com/736x/9f/16/72/9f1672710cba6bcb0dfd93201c6d4c00.jpg",bio:t.bio||"Oops! No bio available.",followers:t.followers||0,following:t.following||0};(0,s.login)(n)}else alert("Login failed. Please check your credentials.")}catch(e){console.error("Unexpected error during login:",e),alert("An unexpected error occurred. Please try again.")}}handleRegisterClick(e){e.preventDefault();const t=new CustomEvent("register");this.dispatchEvent(t)}render(){this.shadowRoot&&(this.shadowRoot.innerHTML=`\n        <style>${i.default}</style> \x3c!-- Aplica estilos --\x3e\n        <div class="login-container">\n          <h2>Log in to Nexus</h2>\n          <form>\n            <div class="form-group">\n              <label for="username">Email</label>\n              <input type="text" id="username" name="username" required>\n            </div>\n            <div class="form-group">\n              <label for="password">Password</label>\n              <input type="password" id="password" name="password" required>\n            </div>\n            <button type="submit" class="login-button">Log In</button>\n          </form>\n          <p class="register-text">\n            Don't have an account? <a href="#" id="register-link">Register now</a>\n          </p>\n        </div>\n      `)}}t.default=a},9006:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Screens=void 0,function(e){e.LANDING="landing",e.THREADS="threads",e.THREAD_DETAIL="thread-detail",e.CATEGORIES="categories",e.COMMUNITY="community",e.PROFILE="profile",e.LOGIN="login",e.REGISTER="register"}(n||(t.Screens=n={}))},9013:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(7047),o=r(n(5078)),i=n(3015);class a extends HTMLElement{uploadedProfilePictureUrl=null;constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render();const e=this.shadowRoot?.querySelector("form"),t=this.shadowRoot?.querySelector(".close-button"),n=this.shadowRoot?.querySelector(".modal-overlay"),r=this.shadowRoot?.querySelector("#profilePicture");e?.addEventListener("submit",this.handleSubmit.bind(this)),t?.addEventListener("click",this.handleClose.bind(this)),n?.addEventListener("click",(e=>{e.target===n&&this.handleClose()})),r?.addEventListener("change",this.handleFileChange.bind(this))}async handleFileChange(e){const t=e.target,n=t.files?.[0];if(n)try{const e=await(0,i.uploadProfilePicture)(n);this.uploadedProfilePictureUrl=e,console.log("Uploaded to:",e),this.renderImage()}catch(e){console.error("Upload failed:",e),alert("Failed to upload image.")}}renderImage(){const e=this.shadowRoot?.querySelector(".image-preview");if(e){e.innerHTML="";const t=document.createElement("img");t.src=this.uploadedProfilePictureUrl||"",t.alt="Profile Picture Preview",t.className="profile-picture-preview",e.appendChild(t)}}async handleSubmit(e){e.preventDefault();const t=s.appState.get();if(!t.currentUser)return;const n=new FormData(e.target),r=n.get("username"),o=n.get("bio"),a={...t.currentUser,username:r,bio:o,profilePicture:this.uploadedProfilePictureUrl||t.currentUser.profilePicture};console.log("Updating profile with:",a);try{await(0,i.updateProfileInDatabase)(t.currentUser.id,a),this.handleClose()}catch(e){console.error("Profile update error:",e),alert("Failed to update profile. Please try again.")}}handleClose(){const e=new CustomEvent("close");this.dispatchEvent(e)}render(){const e=s.appState.get().currentUser;this.shadowRoot&&(this.shadowRoot.innerHTML=`\n        <style>${o.default}</style>\n        <div class="modal-overlay">\n          <div class="modal">\n            <div class="modal-header">\n              <h2 class="modal-title">Edit Profile</h2>\n              <button class="close-button">&times;</button>\n            </div>\n            <form>\n              <div class="form-group">\n                <label for="username">Username</label>\n                <input type="text" id="username" name="username" value="${e?.username||""}" required>\n              </div>\n              <div class="form-group">\n                <label for="bio">Bio</label>\n                <textarea id="bio" name="bio">${e?.bio||""}</textarea>\n              </div>\n              <div class="form-group">\n                <label class="custom-file-upload" for="profilePicture">Profile Picture\n                <input type="file" id="profilePicture" name="profilePicture" accept="image/*">\n                </label>\n                <small>Leave empty to keep current picture.</small>\n                <div class="image-preview"></div>\n              </div>\n              <button type="submit" class="save-button">Save Changes</button>\n            </form>\n          </div>\n        </div>\n      `)}disconnectedCallback(){const e=this.shadowRoot?.querySelector("form"),t=this.shadowRoot?.querySelector(".close-button"),n=this.shadowRoot?.querySelector("#profilePicture");e?.removeEventListener("submit",this.handleSubmit.bind(this)),t?.removeEventListener("click",this.handleClose.bind(this)),n?.removeEventListener("change",this.handleFileChange.bind(this))}}t.default=a},9536:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CommentAttributes=void 0;const s=n(7047),o=r(n(2682)),i=n(3015);var a;!function(e){e.ID="commentid",e.POST_ID="postid",e.USER_ID="userid",e.USERNAME="username",e.PROFILE_PICTURE="pfp",e.CONTENT="content",e.LIKES="likes",e.TIMESTAMP="timestamp"}(a||(t.CommentAttributes=a={}));class c extends HTMLElement{commentid;postid;userid;username;pfp;content;likes;timestamp;static get observedAttributes(){return Object.values(a)}attributeChangedCallback(e,t,n){t!==n&&(this[e]=n)}constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render();const e=this.shadowRoot?.querySelector(".like-btn"),t=s.appState.get();e?.addEventListener("click",(()=>{this.commentid&&t.isAuthenticated&&t.currentUser&&(0,i.likeComment)(this.commentid,t.currentUser.id)}))}formatDate(e){if(!e)return"";const t=new Date(e),n=new Date,r=Math.floor((n.getTime()-t.getTime())/1e3);return r<60?`${r}s ago`:r<3600?`${Math.floor(r/60)}m ago`:r<86400?`${Math.floor(r/3600)}h ago`:t.toLocaleDateString()}render(){if(this.shadowRoot){const e=s.appState.get().comments.find((e=>e.id===this.commentid)),t=e?.isLiked||!1;this.shadowRoot.innerHTML=`\n        <style>${o.default}</style> \x3c!-- Aplica los estilos CSS --\x3e\n        <div class="comment-card">\n          <div class="comment-header">\n            <img class="profile-picture" src="${this.pfp}" alt="${this.username}">\n            <div class="comment-info">\n              <h4 class="username">${this.username}</h4>\n              <span class="timestamp">${this.formatDate(this.timestamp)}</span>\n            </div>\n          </div>\n          <div class="comment-content">\n            <p>${this.content}</p>\n          </div>\n          <div class="comment-actions">\n            <div class="action-btn like-btn ${t?"active":""}">\n              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16">\n                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>\n              </svg>\n              <span class="likes-count">${this.likes}</span> \x3c!-- Muestra la cantidad de likes --\x3e\n            </div>\n          </div>\n        </div>\n      `}}disconnectedCallback(){}}t.default=c},9800:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AppContainer=void 0;const r=n(7047),s=n(3837),o=n(9006);class i extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),r.appState.subscribe((()=>{const e=r.appState.get();if(this.render(e),console.log("State updated, re-rendering AppContainer"),e.currentUser){const t=e.currentUser.id;this.handleUserRealTime(t)}}))}realTimeUser=null;realTimePosts=null;realTimePostUpdates=null;realTimeComments=null;realTimeCommentsLikes=null;handleUserRealTime(e){let t="";e!==t&&(this.realTimeUser?.unsubscribe(),this.realTimeUser=(0,s.initUserRealtimeListener)(e),t=e)}connectedCallback(){this.render();const e=r.appState.get();console.log("AppContainer connected, current state:",e),this.realTimePosts=(0,s.initPostsRealtimeListener)(),this.realTimePostUpdates=(0,s.initPostUpdateListener)(),this.realTimeComments=(0,s.initCommentsRealtimeListener)(),this.realTimeCommentsLikes=(0,s.initCommentsLikeListener)()}disconnectedCallback(){this.realTimeUser?.unsubscribe(),this.realTimePosts?.unsubscribe(),this.realTimePostUpdates?.unsubscribe(),this.realTimeComments?.unsubscribe(),this.realTimeCommentsLikes?.unsubscribe()}render(e=r.appState.get()){if(!this.shadowRoot)return;this.shadowRoot.innerHTML='<app-header></app-header><div id="main"></div>';const t=this.shadowRoot.querySelector("#main");if(t)switch(e.currentScreen){case o.Screens.LANDING:t.appendChild(document.createElement("landing-screen"));break;case o.Screens.THREADS:t.appendChild(document.createElement("threads-screen"));break;case o.Screens.THREAD_DETAIL:t.appendChild(document.createElement("thread-detail-screen"));break;case o.Screens.CATEGORIES:t.appendChild(document.createElement("categories-screen"));break;case o.Screens.COMMUNITY:t.appendChild(document.createElement("community-screen"));break;case o.Screens.PROFILE:t.appendChild(document.createElement("profile-screen"));break;case o.Screens.LOGIN:case o.Screens.REGISTER:t.appendChild(document.createElement("auth-screen"));break;default:t.appendChild(document.createElement("landing-screen"))}}}t.AppContainer=i},9890:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(7047),o=n(6646),i=n(9006),a=r(n(7392));class c extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.render();const e=this.shadowRoot?.querySelector("#threads-link"),t=this.shadowRoot?.querySelector("#categories-link"),n=this.shadowRoot?.querySelector("#community-link"),r=this.shadowRoot?.querySelector("#login-link"),s=this.shadowRoot?.querySelector("#logo-link"),a=this.shadowRoot?.querySelector("#profile-link"),c=this.shadowRoot?.querySelector("#logout-btn");s?.addEventListener("click",(()=>{(0,o.navigate)(i.Screens.LANDING)})),e?.addEventListener("click",(()=>{(0,o.navigate)(i.Screens.THREADS)})),t?.addEventListener("click",(()=>{(0,o.navigate)(i.Screens.CATEGORIES)})),n?.addEventListener("click",(()=>{(0,o.navigate)(i.Screens.COMMUNITY)})),r?.addEventListener("click",(()=>{(0,o.navigate)(i.Screens.LOGIN)})),a?.addEventListener("click",(()=>{(0,o.navigate)(i.Screens.PROFILE)})),c?.addEventListener("click",(()=>{(0,o.logout)()}))}render(){const e=s.appState.get();if(this.shadowRoot){this.shadowRoot.innerHTML=`\n        <style>${a.default}</style> \x3c!-- Aplica los estilos importados dentro del Shaadow DOOM --\x3e\n        <header>\n          <div class="header-container">\n            <div class="logo" id="logo-link">\n              <h1>Nexus</h1> \x3c!-- Nombre del sitio --\x3e\n            </div>\n            <nav class="nav-links">\n              <ul>\n                <li><a id="threads-link" class="${e.currentScreen===i.Screens.THREADS?"active":""}">Threads</a></li>\n                <li><a id="categories-link" class="${e.currentScreen===i.Screens.CATEGORIES?"active":""}">Categories</a></li>\n                <li><a id="community-link" class="${e.currentScreen===i.Screens.COMMUNITY?"active":""}">Community</a></li>\n              </ul>\n            </nav>\n            <div class="auth-section">\n              ${e.isAuthenticated&&e.currentUser?` \n                  \x3c!-- Si el usuario está autenticado, muestra perfil y botón de logout --\x3e\n                  <div class="user-profile" id="profile-link">\n                    <img src="${e.currentUser.profilePicture}" alt="${e.currentUser.username}">\n                    <span>${e.currentUser.username}</span>\n                  </div>\n                  <button id="logout-btn" class="logout-btn">Logout</button>\n                `:'\n                  \x3c!-- Si no está autenticado, muestra botón de login --\x3e\n                  <button id="login-link" class="login-btn">Login</button>\n                '}\n            </div>\n            <div class="menu-toggle">\n              \x3c!-- Icono de menú para dispositivos móviles --\x3e\n              <span></span>\n              <span></span>\n              <span></span>\n            </div>\n          </div>\n        </header>\n      `;const t=this.shadowRoot.querySelector(".menu-toggle"),n=this.shadowRoot.querySelector(".nav-links");t?.addEventListener("click",(()=>{t.classList.toggle("active"),n?.classList.toggle("active")}))}}}t.default=c}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(8156)})();